var Zepto=function(){function t(t){return null==t?String(t):H[U.call(t)]||"object"}function e(e){return"function"==t(e)}function n(t){return null!=t&&t==t.window}function i(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function r(e){return"object"==t(e)}function o(t){return r(t)&&!n(t)&&Object.getPrototypeOf(t)==Object.prototype}function a(t){return"number"==typeof t.length}function s(t){return N.call(t,function(t){return null!=t})}function u(t){return t.length>0?j.fn.concat.apply([],t):t}function c(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function l(t){return t in Z?Z[t]:Z[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function f(t,e){return"number"!=typeof e||_[c(t)]?e:e+"px"}function h(t){var e,n;return k[t]||(e=P.createElement(t),P.body.appendChild(e),n=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),k[t]=n),k[t]}function p(t){return"children"in t?A.call(t.children):j.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function d(t,e,n){for(E in e)n&&(o(e[E])||Y(e[E]))?(o(e[E])&&!o(t[E])&&(t[E]={}),Y(e[E])&&!Y(t[E])&&(t[E]=[]),d(t[E],e[E],n)):e[E]!==w&&(t[E]=e[E])}function m(t,e){return null==e?j(t):j(t).filter(e)}function v(t,n,i,r){return e(n)?n.call(t,i,r):n}function g(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function y(t,e){var n=t.className,i=n&&n.baseVal!==w;return e===w?i?n.baseVal:n:(i?n.baseVal=e:t.className=e,void 0)}function b(t){var e;try{return t?"true"==t||("false"==t?!1:"null"==t?null:/^0/.test(t)||isNaN(e=Number(t))?/^[\[\{]/.test(t)?j.parseJSON(t):t:e):t}catch(n){return t}}function x(t,e){e(t);for(var n in t.childNodes)x(t.childNodes[n],e)}var w,E,j,S,T,C,O=[],A=O.slice,N=O.filter,P=window.document,k={},Z={},_={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},D=/^\s*<(\w+|!)[^>]*>/,M=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,$=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,L=/^(?:body|html)$/i,F=/([A-Z])/g,z=["val","css","html","text","data","width","height","offset"],R=["after","prepend","before","append"],q=P.createElement("table"),W=P.createElement("tr"),I={tr:P.createElement("tbody"),tbody:q,thead:q,tfoot:q,td:W,th:W,"*":P.createElement("div")},B=/complete|loaded|interactive/,V=/^[\w-]*$/,H={},U=H.toString,X={},J=P.createElement("div"),G={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},Y=Array.isArray||function(t){return t instanceof Array};return X.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var n=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(n)return n.call(t,e);var i,r=t.parentNode,o=!r;return o&&(r=J).appendChild(t),i=~X.qsa(r,e).indexOf(t),o&&J.removeChild(t),i},T=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},C=function(t){return N.call(t,function(e,n){return t.indexOf(e)==n})},X.fragment=function(t,e,n){var i,r,a;return M.test(t)&&(i=j(P.createElement(RegExp.$1))),i||(t.replace&&(t=t.replace($,"<$1></$2>")),e===w&&(e=D.test(t)&&RegExp.$1),e in I||(e="*"),a=I[e],a.innerHTML=""+t,i=j.each(A.call(a.childNodes),function(){a.removeChild(this)})),o(n)&&(r=j(i),j.each(n,function(t,e){z.indexOf(t)>-1?r[t](e):r.attr(t,e)})),i},X.Z=function(t,e){return t=t||[],t.__proto__=j.fn,t.selector=e||"",t},X.isZ=function(t){return t instanceof X.Z},X.init=function(t,n){var i;if(!t)return X.Z();if("string"==typeof t)if(t=t.trim(),"<"==t[0]&&D.test(t))i=X.fragment(t,RegExp.$1,n),t=null;else{if(n!==w)return j(n).find(t);i=X.qsa(P,t)}else{if(e(t))return j(P).ready(t);if(X.isZ(t))return t;if(Y(t))i=s(t);else if(r(t))i=[t],t=null;else if(D.test(t))i=X.fragment(t.trim(),RegExp.$1,n),t=null;else{if(n!==w)return j(n).find(t);i=X.qsa(P,t)}}return X.Z(i,t)},j=function(t,e){return X.init(t,e)},j.extend=function(t){var e,n=A.call(arguments,1);return"boolean"==typeof t&&(e=t,t=n.shift()),n.forEach(function(n){d(t,n,e)}),t},X.qsa=function(t,e){var n,r="#"==e[0],o=!r&&"."==e[0],a=r||o?e.slice(1):e,s=V.test(a);return i(t)&&s&&r?(n=t.getElementById(a))?[n]:[]:1!==t.nodeType&&9!==t.nodeType?[]:A.call(s&&!r?o?t.getElementsByClassName(a):t.getElementsByTagName(e):t.querySelectorAll(e))},j.contains=function(t,e){return t!==e&&t.contains(e)},j.type=t,j.isFunction=e,j.isWindow=n,j.isArray=Y,j.isPlainObject=o,j.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},j.inArray=function(t,e,n){return O.indexOf.call(e,t,n)},j.camelCase=T,j.trim=function(t){return null==t?"":String.prototype.trim.call(t)},j.uuid=0,j.support={},j.expr={},j.map=function(t,e){var n,i,r,o=[];if(a(t))for(i=0;i<t.length;i++)n=e(t[i],i),null!=n&&o.push(n);else for(r in t)n=e(t[r],r),null!=n&&o.push(n);return u(o)},j.each=function(t,e){var n,i;if(a(t)){for(n=0;n<t.length;n++)if(e.call(t[n],n,t[n])===!1)return t}else for(i in t)if(e.call(t[i],i,t[i])===!1)return t;return t},j.grep=function(t,e){return N.call(t,e)},window.JSON&&(j.parseJSON=JSON.parse),j.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){H["[object "+e+"]"]=e.toLowerCase()}),j.fn={forEach:O.forEach,reduce:O.reduce,push:O.push,sort:O.sort,indexOf:O.indexOf,concat:O.concat,map:function(t){return j(j.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return j(A.apply(this,arguments))},ready:function(t){return B.test(P.readyState)&&P.body?t(j):P.addEventListener("DOMContentLoaded",function(){t(j)},!1),this},get:function(t){return t===w?A.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return O.every.call(this,function(e,n){return t.call(e,n,e)!==!1}),this},filter:function(t){return e(t)?this.not(this.not(t)):j(N.call(this,function(e){return X.matches(e,t)}))},add:function(t,e){return j(C(this.concat(j(t,e))))},is:function(t){return this.length>0&&X.matches(this[0],t)},not:function(t){var n=[];if(e(t)&&t.call!==w)this.each(function(e){t.call(this,e)||n.push(this)});else{var i="string"==typeof t?this.filter(t):a(t)&&e(t.item)?A.call(t):j(t);this.forEach(function(t){i.indexOf(t)<0&&n.push(t)})}return j(n)},has:function(t){return this.filter(function(){return r(t)?j.contains(this,t):j(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!r(t)?t:j(t)},last:function(){var t=this[this.length-1];return t&&!r(t)?t:j(t)},find:function(t){var e,n=this;return e="object"==typeof t?j(t).filter(function(){var t=this;return O.some.call(n,function(e){return j.contains(e,t)})}):1==this.length?j(X.qsa(this[0],t)):this.map(function(){return X.qsa(this,t)})},closest:function(t,e){var n=this[0],r=!1;for("object"==typeof t&&(r=j(t));n&&!(r?r.indexOf(n)>=0:X.matches(n,t));)n=n!==e&&!i(n)&&n.parentNode;return j(n)},parents:function(t){for(var e=[],n=this;n.length>0;)n=j.map(n,function(t){return(t=t.parentNode)&&!i(t)&&e.indexOf(t)<0?(e.push(t),t):void 0});return m(e,t)},parent:function(t){return m(C(this.pluck("parentNode")),t)},children:function(t){return m(this.map(function(){return p(this)}),t)},contents:function(){return this.map(function(){return A.call(this.childNodes)})},siblings:function(t){return m(this.map(function(t,e){return N.call(p(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return j.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=h(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var n=e(t);if(this[0]&&!n)var i=j(t).get(0),r=i.parentNode||this.length>1;return this.each(function(e){j(this).wrapAll(n?t.call(this,e):r?i.cloneNode(!0):i)})},wrapAll:function(t){if(this[0]){j(this[0]).before(t=j(t));for(var e;(e=t.children()).length;)t=e.first();j(t).append(this)}return this},wrapInner:function(t){var n=e(t);return this.each(function(e){var i=j(this),r=i.contents(),o=n?t.call(this,e):t;r.length?r.wrapAll(o):i.append(o)})},unwrap:function(){return this.parent().each(function(){j(this).replaceWith(j(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=j(this);(t===w?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return j(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return j(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0===arguments.length?this.length>0?this[0].innerHTML:null:this.each(function(e){var n=this.innerHTML;j(this).empty().append(v(this,t,e,n))})},text:function(t){return 0===arguments.length?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=t===w?"":""+t})},attr:function(t,e){var n;return"string"==typeof t&&e===w?0==this.length||1!==this[0].nodeType?w:"value"==t&&"INPUT"==this[0].nodeName?this.val():!(n=this[0].getAttribute(t))&&t in this[0]?this[0][t]:n:this.each(function(n){if(1===this.nodeType)if(r(t))for(E in t)g(this,E,t[E]);else g(this,t,v(this,e,n,this.getAttribute(t)))})},removeAttr:function(t){return this.each(function(){1===this.nodeType&&g(this,t)})},prop:function(t,e){return t=G[t]||t,e===w?this[0]&&this[0][t]:this.each(function(n){this[t]=v(this,e,n,this[t])})},data:function(t,e){var n=this.attr("data-"+t.replace(F,"-$1").toLowerCase(),e);return null!==n?b(n):w},val:function(t){return 0===arguments.length?this[0]&&(this[0].multiple?j(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(e){this.value=v(this,t,e,this.value)})},offset:function(t){if(t)return this.each(function(e){var n=j(this),i=v(this,t,e,n.offset()),r=n.offsetParent().offset(),o={top:i.top-r.top,left:i.left-r.left};"static"==n.css("position")&&(o.position="relative"),n.css(o)});if(0==this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,n){if(arguments.length<2){var i=this[0],r=getComputedStyle(i,"");if(!i)return;if("string"==typeof e)return i.style[T(e)]||r.getPropertyValue(e);if(Y(e)){var o={};return j.each(Y(e)?e:[e],function(t,e){o[e]=i.style[T(e)]||r.getPropertyValue(e)}),o}}var a="";if("string"==t(e))n||0===n?a=c(e)+":"+f(e,n):this.each(function(){this.style.removeProperty(c(e))});else for(E in e)e[E]||0===e[E]?a+=c(E)+":"+f(E,e[E])+";":this.each(function(){this.style.removeProperty(c(E))});return this.each(function(){this.style.cssText+=";"+a})},index:function(t){return t?this.indexOf(j(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return t?O.some.call(this,function(t){return this.test(y(t))},l(t)):!1},addClass:function(t){return t?this.each(function(e){S=[];var n=y(this),i=v(this,t,e,n);i.split(/\s+/g).forEach(function(t){j(this).hasClass(t)||S.push(t)},this),S.length&&y(this,n+(n?" ":"")+S.join(" "))}):this},removeClass:function(t){return this.each(function(e){return t===w?y(this,""):(S=y(this),v(this,t,e,S).split(/\s+/g).forEach(function(t){S=S.replace(l(t)," ")}),y(this,S.trim()),void 0)})},toggleClass:function(t,e){return t?this.each(function(n){var i=j(this),r=v(this,t,n,y(this));r.split(/\s+/g).forEach(function(t){(e===w?!i.hasClass(t):e)?i.addClass(t):i.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return t===w?e?this[0].scrollTop:this[0].pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return t===w?e?this[0].scrollLeft:this[0].pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),n=this.offset(),i=L.test(e[0].nodeName)?{top:0,left:0}:e.offset();return n.top-=parseFloat(j(t).css("margin-top"))||0,n.left-=parseFloat(j(t).css("margin-left"))||0,i.top+=parseFloat(j(e[0]).css("border-top-width"))||0,i.left+=parseFloat(j(e[0]).css("border-left-width"))||0,{top:n.top-i.top,left:n.left-i.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||P.body;t&&!L.test(t.nodeName)&&"static"==j(t).css("position");)t=t.offsetParent;return t})}},j.fn.detach=j.fn.remove,["width","height"].forEach(function(t){var e=t.replace(/./,function(t){return t[0].toUpperCase()});j.fn[t]=function(r){var o,a=this[0];return r===w?n(a)?a["inner"+e]:i(a)?a.documentElement["scroll"+e]:(o=this.offset())&&o[t]:this.each(function(e){a=j(this),a.css(t,v(this,r,e,a[t]()))})}}),R.forEach(function(e,n){var i=n%2;j.fn[e]=function(){var e,r,o=j.map(arguments,function(n){return e=t(n),"object"==e||"array"==e||null==n?n:X.fragment(n)}),a=this.length>1;return o.length<1?this:this.each(function(t,e){r=i?e:e.parentNode,e=0==n?e.nextSibling:1==n?e.firstChild:2==n?e:null,o.forEach(function(t){if(a)t=t.cloneNode(!0);else if(!r)return j(t).remove();x(r.insertBefore(t,e),function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)})})})},j.fn[i?e+"To":"insert"+(n?"Before":"After")]=function(t){return j(t)[e](this),this}}),X.Z.prototype=j.fn,X.uniq=C,X.deserializeValue=b,j.zepto=X,j}();window.Zepto=Zepto,void 0===window.$&&(window.$=Zepto),function(t){function e(t){return t._zid||(t._zid=h++)}function n(t,n,o,a){if(n=i(n),n.ns)var s=r(n.ns);return(v[e(t)]||[]).filter(function(t){return!(!t||n.e&&t.e!=n.e||n.ns&&!s.test(t.ns)||o&&e(t.fn)!==e(o)||a&&t.sel!=a)})}function i(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function r(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function o(t,e){return t.del&&!y&&t.e in b||!!e}function a(t){return x[t]||y&&b[t]||t}function s(n,r,s,u,l,h,p){var d=e(n),m=v[d]||(v[d]=[]);r.split(/\s/).forEach(function(e){if("ready"==e)return t(document).ready(s);var r=i(e);r.fn=s,r.sel=l,r.e in x&&(s=function(e){var n=e.relatedTarget;return!n||n!==this&&!t.contains(this,n)?r.fn.apply(this,arguments):void 0}),r.del=h;var d=h||s;r.proxy=function(t){if(t=c(t),!t.isImmediatePropagationStopped()){t.data=u;var e=d.apply(n,t._args==f?[t]:[t].concat(t._args));return e===!1&&(t.preventDefault(),t.stopPropagation()),e}},r.i=m.length,m.push(r),"addEventListener"in n&&n.addEventListener(a(r.e),r.proxy,o(r,p))})}function u(t,i,r,s,u){var c=e(t);(i||"").split(/\s/).forEach(function(e){n(t,e,r,s).forEach(function(e){delete v[c][e.i],"removeEventListener"in t&&t.removeEventListener(a(e.e),e.proxy,o(e,u))})})}function c(e,n){return(n||!e.isDefaultPrevented)&&(n||(n=e),t.each(S,function(t,i){var r=n[t];e[t]=function(){return this[i]=w,r&&r.apply(n,arguments)},e[i]=E}),(n.defaultPrevented!==f?n.defaultPrevented:"returnValue"in n?n.returnValue===!1:n.getPreventDefault&&n.getPreventDefault())&&(e.isDefaultPrevented=w)),e}function l(t){var e,n={originalEvent:t};for(e in t)j.test(e)||t[e]===f||(n[e]=t[e]);return c(n,t)}var f,h=1,p=Array.prototype.slice,d=t.isFunction,m=function(t){return"string"==typeof t},v={},g={},y="onfocusin"in window,b={focus:"focusin",blur:"focusout"},x={mouseenter:"mouseover",mouseleave:"mouseout"};g.click=g.mousedown=g.mouseup=g.mousemove="MouseEvents",t.event={add:s,remove:u},t.proxy=function(n,i){if(d(n)){var r=function(){return n.apply(i,arguments)};return r._zid=e(n),r}if(m(i))return t.proxy(n[i],n);throw new TypeError("expected function")},t.fn.bind=function(t,e,n){return this.on(t,e,n)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.one=function(t,e,n,i){return this.on(t,e,n,i,1)};var w=function(){return!0},E=function(){return!1},j=/^([A-Z]|returnValue$|layer[XY]$)/,S={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(t,e,n){return this.on(e,t,n)},t.fn.undelegate=function(t,e,n){return this.off(e,t,n)},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.on=function(e,n,i,r,o){var a,c,h=this;return e&&!m(e)?(t.each(e,function(t,e){h.on(t,n,i,e,o)}),h):(m(n)||d(r)||r===!1||(r=i,i=n,n=f),(d(i)||i===!1)&&(r=i,i=f),r===!1&&(r=E),h.each(function(f,h){o&&(a=function(t){return u(h,t.type,r),r.apply(this,arguments)}),n&&(c=function(e){var i,o=t(e.target).closest(n,h).get(0);return o&&o!==h?(i=t.extend(l(e),{currentTarget:o,liveFired:h}),(a||r).apply(o,[i].concat(p.call(arguments,1)))):void 0}),s(h,e,r,i,n,c||a)}))},t.fn.off=function(e,n,i){var r=this;return e&&!m(e)?(t.each(e,function(t,e){r.off(t,n,e)}),r):(m(n)||d(i)||i===!1||(i=n,n=f),i===!1&&(i=E),r.each(function(){u(this,e,i,n)}))},t.fn.trigger=function(e,n){return e=m(e)||t.isPlainObject(e)?t.Event(e):c(e),e._args=n,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,n)})},t.fn.triggerHandler=function(e,i){var r,o;return this.each(function(a,s){r=l(m(e)?t.Event(e):e),r._args=i,r.target=s,t.each(n(s,e.type||e),function(t,e){return o=e.proxy(r),r.isImmediatePropagationStopped()?!1:void 0})}),o},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.trigger(e)}}),["focus","blur"].forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.each(function(){try{this[e]()}catch(t){}}),this}}),t.Event=function(t,e){m(t)||(e=t,t=e.type);var n=document.createEvent(g[t]||"Events"),i=!0;if(e)for(var r in e)"bubbles"==r?i=!!e[r]:n[r]=e[r];return n.initEvent(t,i,!0),c(n)}}(Zepto),function(t){function e(e,n,i){var r=t.Event(n);return t(e).trigger(r,i),!r.isDefaultPrevented()}function n(t,n,i,r){return t.global?e(n||y,i,r):void 0}function i(e){e.global&&0===t.active++&&n(e,null,"ajaxStart")}function r(e){e.global&&!--t.active&&n(e,null,"ajaxStop")}function o(t,e){var i=e.context;return e.beforeSend.call(i,t,e)===!1||n(e,i,"ajaxBeforeSend",[t,e])===!1?!1:(n(e,i,"ajaxSend",[t,e]),void 0)}function a(t,e,i,r){var o=i.context,a="success";i.success.call(o,t,a,e),r&&r.resolveWith(o,[t,a,e]),n(i,o,"ajaxSuccess",[e,i,t]),u(a,e,i)}function s(t,e,i,r,o){var a=r.context;r.error.call(a,i,e,t),o&&o.rejectWith(a,[i,e,t]),n(r,a,"ajaxError",[i,r,t||e]),u(e,i,r)}function u(t,e,i){var o=i.context;i.complete.call(o,e,t),n(i,o,"ajaxComplete",[e,i]),r(i)}function c(){}function l(t){return t&&(t=t.split(";",2)[0]),t&&(t==j?"html":t==E?"json":x.test(t)?"script":w.test(t)&&"xml")||"text"}function f(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function h(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=f(e.url,e.data),e.data=void 0)}function p(e,n,i,r){return t.isFunction(n)&&(r=i,i=n,n=void 0),t.isFunction(i)||(r=i,i=void 0),{url:e,data:n,success:i,dataType:r}}function d(e,n,i,r){var o,a=t.isArray(n),s=t.isPlainObject(n);t.each(n,function(n,u){o=t.type(u),r&&(n=i?r:r+"["+(s||"object"==o||"array"==o?n:"")+"]"),!r&&a?e.add(u.name,u.value):"array"==o||!i&&"object"==o?d(e,u,i,n):e.add(n,u)})}var m,v,g=0,y=window.document,b=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,x=/^(?:text|application)\/javascript/i,w=/^(?:text|application)\/xml/i,E="application/json",j="text/html",S=/^\s*$/;t.active=0,t.ajaxJSONP=function(e,n){if(!("type"in e))return t.ajax(e);var i,r,u=e.jsonpCallback,c=(t.isFunction(u)?u():u)||"jsonp"+ ++g,l=y.createElement("script"),f=window[c],h=function(e){t(l).triggerHandler("error",e||"abort")},p={abort:h};return n&&n.promise(p),t(l).on("load error",function(o,u){clearTimeout(r),t(l).off().remove(),"error"!=o.type&&i?a(i[0],p,e,n):s(null,u||"error",p,e,n),window[c]=f,i&&t.isFunction(f)&&f(i[0]),f=i=void 0}),o(p,e)===!1?(h("abort"),p):(window[c]=function(){i=arguments},l.src=e.url.replace(/\?(.+)=\?/,"?$1="+c),y.head.appendChild(l),e.timeout>0&&(r=setTimeout(function(){h("timeout")},e.timeout)),p)},t.ajaxSettings={type:"GET",beforeSend:c,success:c,error:c,complete:c,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:E,xml:"application/xml, text/xml",html:j,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},t.ajax=function(e){var n=t.extend({},e||{}),r=t.Deferred&&t.Deferred();for(m in t.ajaxSettings)void 0===n[m]&&(n[m]=t.ajaxSettings[m]);i(n),n.crossDomain||(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!=window.location.host),n.url||(n.url=window.location.toString()),h(n),n.cache===!1&&(n.url=f(n.url,"_="+Date.now()));var u=n.dataType,p=/\?.+=\?/.test(n.url);if("jsonp"==u||p)return p||(n.url=f(n.url,n.jsonp?n.jsonp+"=?":n.jsonp===!1?"":"callback=?")),t.ajaxJSONP(n,r);var d,g=n.accepts[u],y={},b=function(t,e){y[t.toLowerCase()]=[t,e]},x=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,w=n.xhr(),E=w.setRequestHeader;if(r&&r.promise(w),n.crossDomain||b("X-Requested-With","XMLHttpRequest"),b("Accept",g||"*/*"),(g=n.mimeType||g)&&(g.indexOf(",")>-1&&(g=g.split(",",2)[0]),w.overrideMimeType&&w.overrideMimeType(g)),(n.contentType||n.contentType!==!1&&n.data&&"GET"!=n.type.toUpperCase())&&b("Content-Type",n.contentType||"application/x-www-form-urlencoded"),n.headers)for(v in n.headers)b(v,n.headers[v]);if(w.setRequestHeader=b,w.onreadystatechange=function(){if(4==w.readyState){w.onreadystatechange=c,clearTimeout(d);var e,i=!1;if(w.status>=200&&w.status<300||304==w.status||0==w.status&&"file:"==x){u=u||l(n.mimeType||w.getResponseHeader("content-type")),e=w.responseText;try{"script"==u?(1,eval)(e):"xml"==u?e=w.responseXML:"json"==u&&(e=S.test(e)?null:t.parseJSON(e))}catch(o){i=o}i?s(i,"parsererror",w,n,r):a(e,w,n,r)}else s(w.statusText||null,w.status?"error":"abort",w,n,r)}},o(w,n)===!1)return w.abort(),s(null,"abort",w,n,r),w;if(n.xhrFields)for(v in n.xhrFields)w[v]=n.xhrFields[v];var j="async"in n?n.async:!0;w.open(n.type,n.url,j,n.username,n.password);for(v in y)E.apply(w,y[v]);return n.timeout>0&&(d=setTimeout(function(){w.onreadystatechange=c,w.abort(),s(null,"timeout",w,n,r)},n.timeout)),w.send(n.data?n.data:null),w},t.get=function(){return t.ajax(p.apply(null,arguments))},t.post=function(){var e=p.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=p.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,n,i){if(!this.length)return this;var r,o=this,a=e.split(/\s/),s=p(e,n,i),u=s.success;return a.length>1&&(s.url=a[0],r=a[1]),s.success=function(e){o.html(r?t("<div>").html(e.replace(b,"")).find(r):e),u&&u.apply(o,arguments)},t.ajax(s),this};var T=encodeURIComponent;t.param=function(t,e){var n=[];return n.add=function(t,e){this.push(T(t)+"="+T(e))},d(n,t,e),n.join("&").replace(/%20/g,"+")}}(Zepto),function(t){t.fn.serializeArray=function(){var e,n=[];return t([].slice.call(this.get(0).elements)).each(function(){e=t(this);var i=e.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&("radio"!=i&&"checkbox"!=i||this.checked)&&n.push({name:e.attr("name"),value:e.val()})}),n},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(e)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),function(t){"__proto__"in{}||t.extend(t.zepto,{Z:function(e,n){return e=e||[],t.extend(e,t.fn),e.selector=n||"",e.__Z=!0,e},isZ:function(e){return"array"===t.type(e)&&"__Z"in e}});try{getComputedStyle(void 0)}catch(e){var n=getComputedStyle;window.getComputedStyle=function(t){try{return n(t)}catch(e){return null}}}}(Zepto),function(t){function e(t){var e=this.os={},n=this.browser={},i=t.match(/Web[kK]it[\/]{0,1}([\d.]+)/),r=t.match(/(Android);?[\s\/]+([\d.]+)?/),o=!!t.match(/\(Macintosh\; Intel /),a=t.match(/(iPad).*OS\s([\d_]+)/),s=t.match(/(iPod)(.*OS\s([\d_]+))?/),u=!a&&t.match(/(iPhone\sOS)\s([\d_]+)/),c=t.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),l=t.match(/Windows Phone ([\d.]+)/),f=c&&t.match(/TouchPad/),h=t.match(/Kindle\/([\d.]+)/),p=t.match(/Silk\/([\d._]+)/),d=t.match(/(BlackBerry).*Version\/([\d.]+)/),m=t.match(/(BB10).*Version\/([\d.]+)/),v=t.match(/(RIM\sTablet\sOS)\s([\d.]+)/),g=t.match(/PlayBook/),y=t.match(/Chrome\/([\d.]+)/)||t.match(/CriOS\/([\d.]+)/),b=t.match(/Firefox\/([\d.]+)/),x=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),w=!y&&t.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),E=w||t.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/);(n.webkit=!!i)&&(n.version=i[1]),r&&(e.android=!0,e.version=r[2]),u&&!s&&(e.ios=e.iphone=!0,e.version=u[2].replace(/_/g,".")),a&&(e.ios=e.ipad=!0,e.version=a[2].replace(/_/g,".")),s&&(e.ios=e.ipod=!0,e.version=s[3]?s[3].replace(/_/g,"."):null),l&&(e.wp=!0,e.version=l[1]),c&&(e.webos=!0,e.version=c[2]),f&&(e.touchpad=!0),d&&(e.blackberry=!0,e.version=d[2]),m&&(e.bb10=!0,e.version=m[2]),v&&(e.rimtabletos=!0,e.version=v[2]),g&&(n.playbook=!0),h&&(e.kindle=!0,e.version=h[1]),p&&(n.silk=!0,n.version=p[1]),!p&&e.android&&t.match(/Kindle Fire/)&&(n.silk=!0),y&&(n.chrome=!0,n.version=y[1]),b&&(n.firefox=!0,n.version=b[1]),x&&(n.ie=!0,n.version=x[1]),E&&(o||e.ios)&&(n.safari=!0,o&&(n.version=E[1])),w&&(n.webview=!0),e.tablet=!!(a||g||r&&!t.match(/Mobile/)||b&&t.match(/Tablet/)||x&&!t.match(/Phone/)&&t.match(/Touch/)),e.phone=!(e.tablet||e.ipod||!(r||u||c||d||m||y&&t.match(/Android/)||y&&t.match(/CriOS\/([\d.]+)/)||b&&t.match(/Mobile/)||x&&t.match(/Touch/)))}e.call(t,navigator.userAgent),t.__detect=e}(Zepto),function(t,e){function n(t){return t.replace(/([a-z])([A-Z])/,"$1-$2").toLowerCase()}function i(t){return r?r+t:t.toLowerCase()}var r,o,a,s,u,c,l,f,h,p,d="",m={Webkit:"webkit",Moz:"",O:"o"},v=window.document,g=v.createElement("div"),y=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,b={};t.each(m,function(t,n){return g.style[t+"TransitionProperty"]!==e?(d="-"+t.toLowerCase()+"-",r=n,!1):void 0}),o=d+"transform",b[a=d+"transition-property"]=b[s=d+"transition-duration"]=b[c=d+"transition-delay"]=b[u=d+"transition-timing-function"]=b[l=d+"animation-name"]=b[f=d+"animation-duration"]=b[p=d+"animation-delay"]=b[h=d+"animation-timing-function"]="",t.fx={off:r===e&&g.style.transitionProperty===e,speeds:{_default:400,fast:200,slow:600},cssPrefix:d,transitionEnd:i("TransitionEnd"),animationEnd:i("AnimationEnd")},t.fn.animate=function(n,i,r,o,a){return t.isFunction(i)&&(o=i,r=e,i=e),t.isFunction(r)&&(o=r,r=e),t.isPlainObject(i)&&(r=i.easing,o=i.complete,a=i.delay,i=i.duration),i&&(i=("number"==typeof i?i:t.fx.speeds[i]||t.fx.speeds._default)/1e3),a&&(a=parseFloat(a)/1e3),this.anim(n,i,r,o,a)},t.fn.anim=function(i,r,d,m,v){var g,x,w,E={},j="",S=this,T=t.fx.transitionEnd,C=!1;if(r===e&&(r=t.fx.speeds._default/1e3),v===e&&(v=0),t.fx.off&&(r=0),"string"==typeof i)E[l]=i,E[f]=r+"s",E[p]=v+"s",E[h]=d||"linear",T=t.fx.animationEnd;else{x=[];for(g in i)y.test(g)?j+=g+"("+i[g]+") ":(E[g]=i[g],x.push(n(g)));j&&(E[o]=j,x.push(o)),r>0&&"object"==typeof i&&(E[a]=x.join(", "),E[s]=r+"s",E[c]=v+"s",E[u]=d||"linear")}return w=function(e){if("undefined"!=typeof e){if(e.target!==e.currentTarget)return;t(e.target).unbind(T,w)}else t(this).unbind(T,w);C=!0,t(this).css(b),m&&m.call(this)},r>0&&(this.bind(T,w),setTimeout(function(){C||w.call(S)},1e3*r+25)),this.size()&&this.get(0).clientLeft,this.css(E),0>=r&&setTimeout(function(){S.each(function(){w.call(this)})},0),this},g=null}(Zepto),function(t){var e,n=[];t.fn.remove=function(){return this.each(function(){this.parentNode&&("IMG"===this.tagName&&(n.push(this),this.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",e&&clearTimeout(e),e=setTimeout(function(){n=[]},6e4)),this.parentNode.removeChild(this))})}}(Zepto),function(t){function e(e,i){var u=e[s],c=u&&r[u];if(void 0===i)return c||n(e);if(c){if(i in c)return c[i];var l=a(i);if(l in c)return c[l]}return o.call(t(e),i)}function n(e,n,o){var u=e[s]||(e[s]=++t.uuid),c=r[u]||(r[u]=i(e));return void 0!==n&&(c[a(n)]=o),c}function i(e){var n={};return t.each(e.attributes||u,function(e,i){0==i.name.indexOf("data-")&&(n[a(i.name.replace("data-",""))]=t.zepto.deserializeValue(i.value))}),n}var r={},o=t.fn.data,a=t.camelCase,s=t.expando="Zepto"+ +new Date,u=[];t.fn.data=function(i,r){return void 0===r?t.isPlainObject(i)?this.each(function(e,r){t.each(i,function(t,e){n(r,t,e)})}):0==this.length?void 0:e(this[0],i):this.each(function(){n(this,i,r)})},t.fn.removeData=function(e){return"string"==typeof e&&(e=e.split(/\s+/)),this.each(function(){var n=this[s],i=n&&r[n];i&&t.each(e||i,function(t){delete i[e?a(this):t]})})},["remove","empty"].forEach(function(e){var n=t.fn[e];t.fn[e]=function(){var t=this.find("*");return"remove"===e&&(t=t.add(this)),t.removeData(),n.call(this)}})}(Zepto),function(t){function e(n){var i=[["resolve","done",t.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",t.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",t.Callbacks({memory:1})]],r="pending",o={state:function(){return r},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var n=arguments;return e(function(e){t.each(i,function(i,r){var s=t.isFunction(n[i])&&n[i];a[r[1]](function(){var n=s&&s.apply(this,arguments);if(n&&t.isFunction(n.promise))n.promise().done(e.resolve).fail(e.reject).progress(e.notify);else{var i=this===o?e.promise():this,a=s?[n]:arguments;e[r[0]+"With"](i,a)}})}),n=null}).promise()},promise:function(e){return null!=e?t.extend(e,o):o}},a={};return t.each(i,function(t,e){var n=e[2],s=e[3];o[e[1]]=n.add,s&&n.add(function(){r=s},i[1^t][2].disable,i[2][2].lock),a[e[0]]=function(){return a[e[0]+"With"](this===a?o:this,arguments),this},a[e[0]+"With"]=n.fireWith}),o.promise(a),n&&n.call(a,a),a}var n=Array.prototype.slice;t.when=function(i){var r,o,a,s=n.call(arguments),u=s.length,c=0,l=1!==u||i&&t.isFunction(i.promise)?u:0,f=1===l?i:e(),h=function(t,e,i){return function(o){e[t]=this,i[t]=arguments.length>1?n.call(arguments):o,i===r?f.notifyWith(e,i):--l||f.resolveWith(e,i)}};if(u>1)for(r=new Array(u),o=new Array(u),a=new Array(u);u>c;++c)s[c]&&t.isFunction(s[c].promise)?s[c].promise().done(h(c,a,s)).fail(f.reject).progress(h(c,o,r)):--l;return l||f.resolveWith(a,s),f.promise()},t.Deferred=e}(Zepto),function(t){t.Callbacks=function(e){e=t.extend({},e);var n,i,r,o,a,s,u=[],c=!e.once&&[],l=function(t){for(n=e.memory&&t,i=!0,s=o||0,o=0,a=u.length,r=!0;u&&a>s;++s)if(u[s].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}r=!1,u&&(c?c.length&&l(c.shift()):n?u.length=0:f.disable())},f={add:function(){if(u){var i=u.length,s=function(n){t.each(n,function(t,n){"function"==typeof n?e.unique&&f.has(n)||u.push(n):n&&n.length&&"string"!=typeof n&&s(n)})};s(arguments),r?a=u.length:n&&(o=i,l(n))}return this},remove:function(){return u&&t.each(arguments,function(e,n){for(var i;(i=t.inArray(n,u,i))>-1;)u.splice(i,1),r&&(a>=i&&--a,s>=i&&--s)}),this},has:function(e){return!(!u||!(e?t.inArray(e,u)>-1:u.length))},empty:function(){return a=u.length=0,this},disable:function(){return u=c=n=void 0,this
},disabled:function(){return!u},lock:function(){return c=void 0,n||f.disable(),this},locked:function(){return!c},fireWith:function(t,e){return!u||i&&!c||(e=e||[],e=[t,e.slice?e.slice():e],r?c.push(e):l(e)),this},fire:function(){return f.fireWith(this,arguments)},fired:function(){return!!i}};return f}}(Zepto),function(t){function e(e){return e=t(e),!(!e.width()&&!e.height())&&"none"!==e.css("display")}function n(t,e){t=t.replace(/=#\]/g,'="#"]');var n,i,r=s.exec(t);if(r&&r[2]in a&&(n=a[r[2]],i=r[3],t=r[1],i)){var o=Number(i);i=isNaN(o)?i.replace(/^["']|["']$/g,""):o}return e(t,n,i)}var i=t.zepto,r=i.qsa,o=i.matches,a=t.expr[":"]={visible:function(){return e(this)?this:void 0},hidden:function(){return e(this)?void 0:this},selected:function(){return this.selected?this:void 0},checked:function(){return this.checked?this:void 0},parent:function(){return this.parentNode},first:function(t){return 0===t?this:void 0},last:function(t,e){return t===e.length-1?this:void 0},eq:function(t,e,n){return t===n?this:void 0},contains:function(e,n,i){return t(this).text().indexOf(i)>-1?this:void 0},has:function(t,e,n){return i.qsa(this,n).length?this:void 0}},s=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),u=/^\s*>/,c="Zepto"+ +new Date;i.qsa=function(e,o){return n(o,function(n,a,s){try{var l;!n&&a?n="*":u.test(n)&&(l=t(e).addClass(c),n="."+c+" "+n);var f=r(e,n)}catch(h){throw console.error("error performing selector: %o",o),h}finally{l&&l.removeClass(c)}return a?i.uniq(t.map(f,function(t,e){return a.call(t,e,f,s)})):f})},i.matches=function(t,e){return n(e,function(e,n,i){return!(e&&!o(t,e)||n&&n.call(t,null,i)!==t)})}}(Zepto),function(t){function e(t){return"tagName"in t?t:t.parentNode}if(t.os.ios){var n,i={};t(document).bind("gesturestart",function(t){{var r=Date.now();r-(i.last||r)}i.target=e(t.target),n&&clearTimeout(n),i.e1=t.scale,i.last=r}).bind("gesturechange",function(t){i.e2=t.scale}).bind("gestureend",function(){i.e2>0?(0!=Math.abs(i.e1-i.e2)&&t(i.target).trigger("pinch")&&t(i.target).trigger("pinch"+(i.e1-i.e2>0?"In":"Out")),i.e1=i.e2=i.last=0):"last"in i&&(i={})}),["pinch","pinchIn","pinchOut"].forEach(function(e){t.fn[e]=function(t){return this.bind(e,t)}})}}(Zepto),function(t){t.fn.end=function(){return this.prevObject||t()},t.fn.andSelf=function(){return this.add(this.prevObject||t())},"filter,add,not,eq,first,last,find,closest,parents,parent,children,siblings".split(",").forEach(function(e){var n=t.fn[e];t.fn[e]=function(){var t=n.apply(this,arguments);return t.prevObject=this,t}})}(Zepto),function(t){t.fn.cookie=function(t,e){var n=function(t,e,n){var i=new Date;return i.setDate(i.getDate()+n),document.cookie=t+"="+escape(e)+(null==n?"":";expires="+i.toGMTString()),!0},i=function(t){if(document.cookie.length>0){var e=document.cookie.indexOf(t+"=");if(-1!=e){e=e+t.length+1;var n=document.cookie.indexOf(";",e);return-1==n&&(n=document.cookie.length),unescape(document.cookie.substring(e,n))}}return""};return"undefined"!=typeof e?n(t,e,365):i(t)}}(Zepto);
!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("Avalon requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(){avalon.config.debug&&console.log.apply(console,arguments)}function a(){return Object.create(null)}function r(){}function i(e,t){"string"==typeof e&&(e=e.match(xt)||[]);for(var n={},a=void 0!==t?t:1,r=0,i=e.length;i>r;r++)n[e[r]]=a;return n}function o(){if(e.VBArray){var t=document.documentMode;return t?t:e.XMLHttpRequest?7:6}return 0/0}function l(e){if(e&&"object"==typeof e){var t=e.length,n=Mt.call(e);if(/(Array|List|Collection|Map|Arguments)\]$/.test(n))return!0;if("[object Object]"===n&&t===t>>>0)return!0}return!1}function s(e,t){if(e&&e.childNodes)for(var n,a=e.childNodes,r=0;n=a[r++];)if(n.tagName){var i=pt.createElementNS(Ft,n.tagName.toLowerCase());Ot.forEach.call(n.attributes,function(e){i.setAttribute(e.name,e.value)}),s(n,i),t.appendChild(i)}}function c(e){for(var t in e)if(At.call(e,t)){var n=e[t];"function"==typeof c.plugins[t]?c.plugins[t](n):"object"==typeof c[t]?avalon.mix(c[t],n):c[t]=n}return this}function u(e){return(e+"").replace(Gt,"\\$&")}function f(e,t,n){if(Array.isArray(e)){var r=e.concat();e.length=0;var i=b(e);return i.pushArray(r),i}if(!e||e.nodeType>0||e.$id&&e.$events)return e;var o=Array.isArray(e.$skipArray)?e.$skipArray:[];o.$special=t||a();var l={};n=n||{};var s=a(),c=a(),u=[];en.forEach(function(t){delete e[t]});var f=Object.keys(e);f.forEach(function(t,a){var r=e[t];if(n[t]=r,y(t,r,o)){s[t]=[];var i=avalon.type(r);"object"===i&&_t(r.get)&&Object.keys(r).length<=2?(a=v(t,r),u.push(a)):a=Ct.test(i)?p(t,r,i,s[t]):d(t,r),c[t]=a}}),l=Object.defineProperties(l,an(c));for(var h=0;h<f.length;h++){var m=f[h];c[m]||(l[m]=e[m])}l.$id=Ht(),l.$model=n,l.$events=s,l.$propertyNames=f.sort().join("&shy;");for(h in Kt)l[h]=Kt[h];return Object.defineProperty(l,"hasOwnProperty",tn),l.$reinitialize=function(){u.forEach(function(e){delete e._value,delete e.oldArgs,e.digest=function(){e.call(l)},ln.begin({callback:function(t,n){var a=n._name;if(n!==e){var r=t.$events[a];e.vm=l,x(r,e.digest)}}});try{e.get.call(l)}finally{ln.end()}})},l.$reinitialize(),l}function d(e,t){function n(e){var t=n._value;return arguments.length>0?(wt||nn(e,t)||(n.updateValue(this,e),n.notify(this,e,t)),this):(ln.collectDependency(this,n),t)}return g(n,e),n._value=t,n}function v(e,t){function n(t){var a=n._value,r="_value"in n;if(arguments.length>0){if(wt)return this;if("function"==typeof n.set&&n.oldArgs!==t){n.oldArgs=t;var i=this.$events,o=i[e];i[e]=[],n.set.call(this,t),i[e]=o,t=n.get.call(this),t!==a&&(n.updateValue(this,t),n.notify(this,t,a))}return this}return t=n.get.call(this),n.updateValue(this,t),r&&a!==t&&n.notify(this,t,a),t}return n.set=t.set,n.get=t.get,g(n,e),n}function p(e,t,n,a){function r(e){var t=r._value,a=r._vmodel;if(arguments.length>0){if(wt)return this;if("array"===n){var i=a,o=e,l=i.length,s=o.length;i.$lock=!0,l>s?i.splice(s,l-s):s>l&&i.push.apply(i,o.slice(l));for(var c=Math.min(l,s),u=0;c>u;u++)i.set(u,o[u]);delete i.$lock,i._fire("set")}else if("object"===n){var d=Object.keys(e).sort().join("&shy;");if(a.$propertyNames===d)for(u in e)a[u]=e[u];else{var v=r._vmodel=f(e),p=v.$events,h=a.$events;for(var u in p){var m=p[u];Array.isArray(m)&&(m=m.concat(h[u]))}p[yt]=h[yt],v.$proxy=a.$proxy,a=v}}return r.updateValue(this,a.$model),r.notify(this,this._value,t),this}return ln.collectDependency(this,r),a}g(r,e);var i=r._vmodel=f(t);return i.$events[yt]=a,r}function h(e,t){e.$model[this._name]=this._value=t}function m(e,t,n){var a=this._name,r=e.$events[a];r&&(C(r),Kt.$fire.call(e,a,t,n))}function g(e,t){e._name=t,e.updateValue=h,e.notify=m}function y(e,t,n){if(_t(t)||t&&t.nodeType)return!1;if(-1!==n.indexOf(e))return!1;var a=n.$special;return e&&"$"===e.charAt(0)&&!a[e]?!1:!0}function b(e){var t=[];t.$id=Ht(),t.$model=e,t.$events={},t.$events[yt]=[],t._=f({length:e.length}),t._.$watch("length",function(e,n){t.$fire("length",e,n)});for(var n in Kt)t[n]=Kt[n];return avalon.mix(t,on),t}function $(e,t,n,a,r,i,o){for(var l=this.length,s=2;--s;){switch(e){case"add":var c=this.$model.slice(t,t+n).map(function(e){return Ct.test(avalon.type(e))?e.$id?e:f(e,0,e):e});rn.apply(this,[t,0].concat(c)),this._fire("add",t,n);break;case"del":var u=this._splice(t,n);this._fire("del",t,n)}r&&(e=r,t=i,n=o,s=2,r=0)}return this._fire("index",a),this.length!==l&&(this._.length=this.length),u}function w(e,t){for(var n={},a=0,r=t.length;r>a;a++){n[a]=e[a];var i=t[a];i in n?(e[a]=n[i],delete n[i]):e[a]=e[i]}}function x(e,t){t.oneTime||e&&avalon.Array.ensure(e,t)&&t.element&&E(t,e)}function C(e){if(e&&e.length){new Date-fn>444&&"object"==typeof e[0]&&T();for(var t,n=Nt.call(arguments,1),a=e.length;t=e[--a];){var r=t.element;if(r&&r.parentNode)try{var i=t.evaluator;if(t.$repeat)t.handler.apply(t,n);else if("$repeat"in t||!i)It[t.type](t,t.vmodels);else if("on"!==t.type){var o=i.apply(0,t.args||[]);t.handler(o,r,t)}}catch(l){}}}}function k(e,t){return e.uuid||t||(e.uuid=++cn,vn[e.uuid]=e),e.uuid}function E(e,t){var n=e.element;e.uuid||(e.uuid=1!==n.nodeType?e.type+(e.pos||0)+"-"+k(n.parentNode):e.name+"-"+k(n));var a=e.lists||(e.lists=[]);avalon.Array.ensure(a,t),t.$uuid=t.$uuid||Ht(),un[e.uuid]||(un[e.uuid]=1,un.push(e))}function T(e){if(!avalon.optimize){for(var t=un.length,n=t,a=[],r={},i={};e=un[--t];){var o=e.type;i[o]?i[o]++:(i[o]=1,a.push(o))}var l=!1;if(a.forEach(function(e){dn[e]!==i[e]&&(r[e]=1,l=!0)}),t=n,l)for(;e=un[--t];)if(e.element&&r[e.type]&&M(e.element)){un.splice(t,1),delete un[e.uuid],delete vn[e.element.uuid];for(var s,c=e.lists,u=0;s=c[u++];)avalon.Array.remove(c,s),avalon.Array.remove(s,e);A(e)}dn=i,fn=new Date}}function A(e){e.element=null,e.rollback&&e.rollback();for(var t in e)e[t]=null}function M(e){try{if(!e.parentNode)return!0}catch(t){return!0}return e.msRetain?0:1===e.nodeType?!jt.contains(e):!avalon.contains(jt,e)}function O(e){return e.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function N(e){return e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(/[-_][^-_]/g,function(e){return e.charAt(1).toUpperCase()})}function S(e){try{if("object"==typeof e)return e;e="true"===e?!0:"false"===e?!1:"null"===e?null:+e+""===e?+e:$n.test(e)?JSON.parse(e):e}catch(t){}return e}function j(e){return e.window&&e.document?e:9===e.nodeType?e.defaultView:!1}function L(e,t){if(e.offsetWidth<=0){var n=getComputedStyle(e,null);if(En.test(n.display)){var a={node:e};for(var r in kn)a[r]=n[r],e.style[r]=kn[r];t.push(a)}var i=e.parentNode;i&&1===i.nodeType&&L(i,t)}}function D(e){var t=e.tagName.toLowerCase();return"input"===t&&/checkbox|radio/.test(e.type)?"checked":t}function H(e,t,n,a){for(var r,i=[],o=" = "+n+".",l=e.length;r=e[--l];)t.hasOwnProperty(r)&&(i.push(r+o+r),a.vars.push(r),"duplex"===a.type&&(e.get=n+"."+r),e.splice(l,1));return i}function P(e){for(var t=[],n={},a=0;a<e.length;a++){var r=e[a],i=r&&"string"==typeof r.$id?r.$id:r;n[i]||(n[i]=t.push(r))}return t}function _(e,t){return t=t.replace(Rn,"").replace(Bn,function(){return"],|"}).replace(Fn,function(e,t){return"["+An(t)}).replace(Vn,function(){return'"],["'}).replace(zn,function(){return'",'})+"]","return avalon.filters.$filter("+e+", "+t+")"}function I(e,t,a){var i=a.type,o=a.filters||"",l=t.map(function(e){return String(e.$id).replace(In,"$1")})+e+i+o,s=Hn(e).concat(),c=[],u=[],f=[],d="";t=P(t),a.vars=[];for(var v=0,p=t.length;p>v;v++)if(s.length){var h="vm"+vt+"_"+v;u.push(h),f.push(t[v]),c.push.apply(c,H(s,t[v],h,a))}if(c.length||"duplex"!==i){"duplex"!==i&&(e.indexOf("||")>-1||e.indexOf("&&")>-1)&&a.vars.forEach(function(t){var n=new RegExp("\\b"+t+"(?:\\.\\w+|\\[\\w+\\])+","ig");e=e.replace(n,function(n){var a=n.charAt(t.length),r=Pt?e.slice(arguments[1]+n.length):RegExp.rightContext,i=/^\s*\(/.test(r);if("."===a||"["===a||i){var o="var"+String(Math.random()).replace(/^0\./,"");if(i){var l=n.split(".");if(l.length>2){var s=l.pop();return c.push(o+" = "+l.join(".")),o+"."+s}return n}return c.push(o+" = "+n),o}return n})}),a.args=f,delete a.vars;var m=Pn.get(l);if(m)return a.evaluator=m,void 0;if(d=c.join(", "),d&&(d="var "+d),/\S/.test(o)){if(!/text|html/.test(a.type))throw Error("ms-"+a.type+"不支持过滤器");e="\nvar ret"+vt+" = "+e+";\r\n",e+=_("ret"+vt,o)}else{if("duplex"===i){var g="'use strict';\nreturn function(vvv){\n	"+d+";\n	if(!arguments.length){\n		return "+e+"\n	}\n	"+(_n.test(e)?e:s.get)+"= vvv;\n} ";try{m=Function.apply(r,u.concat(g)),a.evaluator=Pn.put(l,m)}catch(y){n("debug: parse error,"+y.message)}return}if("on"===i){-1===e.indexOf("(")?e+=".call(this, $event)":e=e.replace("(",".call(this,"),u.push("$event"),e="\nreturn "+e+";";var b=e.lastIndexOf("\nreturn"),$=e.slice(0,b),w=e.slice(b);e=$+"\n"+w}else e="\nreturn "+e+";"}try{m=Function.apply(r,u.concat("'use strict';\n"+d+e)),a.evaluator=Pn.put(l,m)}catch(y){n("debug: parse error,"+y.message)}finally{s=c=u=null}}}function R(e,t,n,a,r){Array.isArray(a)&&(e=a.map(function(e){return e.expr?"("+e.value+")":An(e.value)}).join(" + ")),I(e,t,n),n.evaluator&&!r&&(n.handler=Rt[n.handlerName||n.type],avalon.injectBinding(n))}function B(e,t,n){var a=setTimeout(function(){var r=e.innerHTML;clearTimeout(a),r===n?t():B(e,t,r)})}function F(e,t){var n=e.getAttribute("avalonctrl")||t.$id;e.setAttribute("avalonctrl",n),t.$events.expr=e.tagName+'[avalonctrl="'+n+'"]'}function V(e,t){for(var n,a=0;n=e[a++];)n.vmodels=t,It[n.type](n,t),n.evaluator&&n.element&&1===n.element.nodeType&&n.element.removeAttribute(n.name);e.length=0}function z(e,t){return e.priority-t.priority}function W(e,t,r){var i=!0;if(t.length){for(var o,l=e.attributes,s=[],c=[],u=a(),f=0;o=l[f++];)if(o.specified&&(r=o.name.match(qn))){var d=r[1],v=r[2]||"",p=o.value,h=o.name;if(Zn[d]?(v=d,d="on"):Jn[d]&&("enabled"===d&&(n("warning!ms-enabled或ms-attr-enabled已经被废弃"),d="disabled",p="!("+p+")"),v=d,d="attr",h="ms-"+d+"-"+v,c.push([o.name,h,p])),u[h]=p,"function"==typeof It[d]){var m=p.replace(Un,""),g=p!==m,y={type:d,param:v,element:e,name:h,value:m,oneTime:g,priority:(Gn[d]||10*d.charCodeAt(0))+(Number(v.replace(/\D/g,""))||0)};if("html"===d||"text"===d){var b=q(p);avalon.mix(y,b),y.filters=y.filters.replace(ea,function(){return y.type="html",y.group=1,""})}else if("duplex"===d)var $=h;else"ms-if-loop"===h&&(y.priority+=100);s.push(y),"widget"===d&&(e.msData=e.msData||u)}}if(s.length){s.sort(z),c.forEach(function(t){n("warning!请改用"+t[1]+"代替"+t[0]+"!"),e.removeAttribute(t[0]),e.setAttribute(t[1],t[2])});var w=e.type;for(w&&$&&(u["ms-attr-checked"]&&n("warning!"+w+"控件不能同时定义ms-attr-checked与"+$),u["ms-attr-value"]&&n("warning!"+w+"控件不能同时定义ms-attr-value与"+$)),f=0;y=s[f];f++){if(d=y.type,Kn.test(d))return V(s.slice(0,f+1),t);i&&(i=!Qn.test(d))}V(s,t)}}i&&!Wn[e.tagName]&&qt.test(e.innerHTML+e.textContent)&&(Yn&&Yn(e),X(e,t))}function X(e,t){var n=avalon.slice(e.childNodes);Y(n,t)}function Y(e,t){for(var n,a=0;n=e[a++];)switch(n.nodeType){case 1:U(n,t),n.msCallback&&(n.msCallback(),n.msCallback=void 0);break;case 3:Yt.test(n.nodeValue)&&Z(n,t,a)}}function U(e,t,n){var a=e.getAttribute("ms-skip"),r=e.getAttributeNode("ms-important"),i=e.getAttributeNode("ms-controller");if("string"!=typeof a){if(n=r||i){var o=avalon.vmodels[n.value];if(!o)return;t=n===r?[o]:[o].concat(t),e.removeAttribute(n.name),e.classList.remove(n.name),F(e,o)}W(e,t)}}function q(e){if(e.indexOf("|")>0){var t=e.replace(na,function(e){return Array(e.length+1).join("1")}),n=t.replace(ta,"ᄢ㍄").indexOf("|");if(n>-1)return{filters:e.slice(n),value:e.slice(0,n),expr:!0}}return{value:e,filters:"",expr:!0}}function G(e){for(var t,n,a=[],r=0;;){if(n=e.indexOf(Wt,r),-1===n)break;if(t=e.slice(r,n),t&&a.push({value:t,filters:"",expr:!1}),r=n+Wt.length,n=e.indexOf(Xt,r),-1===n)break;t=e.slice(r,n),t&&a.push(q(t,r)),r=n+Xt.length}return t=e.slice(r),t&&a.push({value:t,expr:!1,filters:""}),a}function Z(e,t,n){var a=[];if(tokens=G(e.data),tokens.length){for(var r=0;token=tokens[r++];){var i=pt.createTextNode(token.value);token.expr&&(token.value=token.value.replace(Un,function(){return token.oneTime=!0,""}),token.type="text",token.element=i,token.filters=token.filters.replace(ea,function(){return token.type="html",""}),token.pos=1e3*n+r,a.push(token)),Lt.appendChild(i)}e.parentNode.replaceChild(Lt,e),a.length&&V(a,t)}}function J(e,t,n){var a=e.templateCache&&e.templateCache[t];if(a){for(var r,i=pt.createDocumentFragment();r=a.firstChild;)i.appendChild(r);return i}return avalon.parseHTML(n)}function K(e){return null==e?"":e}function Q(e,t,n){return t.param.replace(/\w+/g,function(a){var r=avalon.duplexHooks[a];r&&"function"==typeof r[n]&&(e=r[n](e,t))}),e}function et(){for(var e=va.length-1;e>=0;e--){var t=va[e];t()===!1&&va.splice(e,1)}va.length||clearInterval(da)}function tt(e,t,n,a){var r=e.template.cloneNode(!0),i=avalon.slice(r.childNodes);r.insertBefore(pt.createComment(e.signature),r.firstChild),t.appendChild(r);var o=[n].concat(e.vmodels),l={nodes:i,vmodels:o};a.push(l)}function nt(e){for(var t,n=[],a=e.element.parentNode.childNodes,r=0;t=a[r++];)if(t.nodeValue===e.signature)n.push(t);else if(t.nodeValue===e.signature+":end")break;return n}function at(e,t,n){for(;;){var a=t.previousSibling;if(!a)break;if(a.parentNode.removeChild(a),n&&n.call(a),a===e)break}}function rt(){var e=f({$key:"",$outer:{},$host:{},$val:{get:function(){return this.$host[this.$key]},set:function(e){this.$host[this.$key]=e}}},{$val:1});return e.$id=Ht("$proxy$with"),e}function it(e,t,n){e=e||ga.pop(),e?e.$reinitialize():e=rt();var a=n.$repeat;return e.$key=t,e.$host=a,e.$outer=n.$outer,a.$events?e.$events.$val=a.$events[t]:e.$events={},e}function ot(e){lt(e)}function lt(e){e.forEach(function(e){ut(e,ya)}),e.length=0}function st(e){var t={$host:[],$outer:{},$index:0,$first:!1,$last:!1,$remove:avalon.noop};t[e]={get:function(){var t=this.$events,n=t.$index;t.$index=t[e];try{return this.$host[this.$index]}finally{t.$index=n}},set:function(e){try{var t=this.$events,n=t.$index;t.$index=[],this.$host.set(this.$index,e)}finally{t.$index=n}}};var n={$last:1,$first:1,$index:1},a=f(t,n);return a.$id=Ht("$proxy$each"),a}function ct(e,t){for(var n,a=t.param||"el",r=0,i=ya.length;i>r;r++){var o=ya[r];o&&o.hasOwnProperty(a)&&(n=o,ya.splice(r,1))}n||(n=st(a));var l=t.$repeat,s=l.length-1;return n.$index=e,n.$first=0===e,n.$last=e===s,n.$host=l,n.$outer=t.$outer,n.$remove=function(){return l.removeAt(n.$index)},n}function ut(e,t){for(var n in e.$events)Array.isArray(e.$events[n])&&(e.$events[n].forEach(function(e){"object"==typeof e&&A(e)}),e.$events[n].length=0);e.$host=e.$outer={},t.unshift(e)>c.maxRepeatSize&&t.pop()}function ft(e,t){var n="_"+e;if(!ft[n]){var a=pt.createElement(e);jt.appendChild(a),t=St?getComputedStyle(a,null).display:a.currentStyle.display,jt.removeChild(a),ft[n]=t}return ft[n]}function dt(e,t,n,a){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var r=isFinite(+e)?+e:0,i=isFinite(+t)?Math.abs(t):3,o=a||",",l=n||".",s="",c=function(e,t){var n=Math.pow(10,t);return""+(Math.round(e*n)/n).toFixed(t)};return s=(i?c(r,i):""+Math.round(r)).split("."),s[0].length>3&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,o)),(s[1]||"").length<i&&(s[1]=s[1]||"",s[1]+=new Array(i-s[1].length+1).join("0")),s.join(l)}var vt=Date.now(),pt=e.document,ht=pt.head;ht.insertAdjacentHTML("afterBegin",'<avalon ms-skip class="avalonHide"><style id="avalonStyle">.avalonHide{ display: none!important }</style></avalon>');var mt,gt=ht.firstChild,yt="$"+vt,bt=e.require,$t=e.define,wt=!1,xt=/[^, ]+/g,Ct=/^(?:object|array)$/,kt=/^\[object SVG\w*Element\]$/,Et=/^\[object (?:Window|DOMWindow|global)\]$/,Tt=Object.prototype,At=Tt.hasOwnProperty,Mt=Tt.toString,Ot=Array.prototype,Nt=Ot.slice,St=e.dispatchEvent,jt=pt.documentElement,Lt=pt.createDocumentFragment(),Dt=(pt.createElement("div"),{});"Boolean Number String Function Array Date RegExp Object Error".replace(xt,function(e){Dt["[object "+e+"]"]=e.toLowerCase()});var Ht=function(e){return e=e||"avalon",String(Math.random()+Math.random()).replace(/\d\.\d{4}/,e)},Pt=o();avalon=function(e){return new avalon.init(e)},avalon.profile=function(){e.console&&avalon.config.profile&&Function.apply.call(console.log,console,arguments)},avalon.nextTick=new function(){function t(){for(var e=i.length,t=0;e>t;t++)i[t]();i=i.slice(e)}var n=e.setImmediate,a=e.MutationObserver,r=St&&e.postMessage;if(n)return n.bind(e);var i=[];if(a){var o=document.createTextNode("avalon");return new a(t).observe(o,{characterData:!0}),function(e){i.push(e),o.data=Math.random()}}return r?(e.addEventListener("message",function(n){var a=n.source;a!==e&&null!==a||"process-tick"!==n.data||(n.stopPropagation(),t())}),function(t){i.push(t),e.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}},avalon.init=function(e){this[0]=this.element=e},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?Dt[Mt.call(e)]||"object":typeof e};var _t=function(e){return"[object Function]"===Mt.call(e)};avalon.isFunction=_t,avalon.isWindow=function(e){return Et.test(Mt.call(e))},avalon.isPlainObject=function(e){return"[object Object]"===Mt.call(e)&&Object.getPrototypeOf(e)===Tt},avalon.mix=avalon.fn.mix=function(){var e,t,n,a,r,i,o=arguments[0]||{},l=1,s=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[1]||{},l++),"object"==typeof o||_t(o)||(o={}),l===s&&(o=this,l--);s>l;l++)if(null!=(e=arguments[l]))for(t in e)n=o[t],a=e[t],o!==a&&(c&&a&&(avalon.isPlainObject(a)||(r=Array.isArray(a)))?(r?(r=!1,i=n&&Array.isArray(n)?n:[]):i=n&&avalon.isPlainObject(n)?n:{},o[t]=avalon.mix(c,i,a)):void 0!==a&&(o[t]=a));return o},avalon.mix({rword:xt,subscribers:yt,version:1.45,ui:{},log:n,slice:function(e,t,n){return Nt.call(e,t,n)},noop:r,error:function(e,t){throw new(t||Error)(e)},oneObject:i,range:function(e,t,n){n||(n=1),null==t&&(t=e||0,e=0);for(var a=-1,r=Math.max(0,Math.ceil((t-e)/n)),i=new Array(r);++a<r;)i[a]=e,e+=n;return i},eventHooks:{},bind:function(e,t,n,a){var r=avalon.eventHooks,i=r[t];return"object"==typeof i&&(t=i.type,i.deel&&(n=i.deel(e,t,n,a))),n.unbind||e.addEventListener(t,n,!!a),n},unbind:function(e,t,n,a){var i=avalon.eventHooks,o=i[t],l=n||r;"object"==typeof o&&(t=o.type,o.deel&&(n=o.deel(e,t,n,!1))),e.removeEventListener(t,l,!!a)},css:function(e,t,n){e instanceof avalon&&(e=e[0]);var a,r=/[_-]/.test(t)?N(t):t;if(t=avalon.cssName(r)||r,void 0===n||"boolean"==typeof n){a=wn[r+":get"]||wn["@:get"],"background"===t&&(t="backgroundColor");var i=a(e,t);return n===!0?parseFloat(i)||0:i}if(""===n)e.style[t]="";else{if(null==n||n!==n)return;isFinite(n)&&!avalon.cssNumber[r]&&(n+="px"),a=wn[r+":set"]||wn["@:set"],a(e,t,n)}},each:function(e,t){if(e){var n=0;if(l(e))for(var a=e.length;a>n&&t(n,e[n])!==!1;n++);else for(n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)break}},getWidgetData:function(e,t){var n=avalon(e).data(),a={};for(var r in n)0===r.indexOf(t)&&(a[r.replace(t,"").replace(/\w/,function(e){return e.toLowerCase()})]=n[r]);return a},Array:{ensure:function(e,t){return-1===e.indexOf(t)?e.push(t):void 0},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return~n?avalon.Array.removeAt(e,n):!1}}});var It=avalon.bindingHandlers={},Rt=avalon.bindingExecutors={},Bt=new function(){function e(e){this.size=0,this.limit=e,this.head=this.tail=void 0,this._keymap={}}var t=e.prototype;return t.put=function(e,t){var n={key:e,value:t};return this._keymap[e]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit?this.shift():this.size++,t},t.shift=function(){var e=this.head;e&&(this.head=this.head.newer,this.head.older=e.newer=e.older=this._keymap[e.key]=void 0)},t.get=function(e){var t=this._keymap[e];if(void 0!==t)return t===this.tail?t.value:(t.newer&&(t===this.head&&(this.head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this.tail,this.tail&&(this.tail.newer=t),this.tail=t,t.value)},e};if(pt.contains||(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))}),avalon.contains=function(e,t){try{for(;t=t.parentNode;)if(t===e)return!0;return!1}catch(n){return!1}},e.SVGElement){var Ft="http://www.w3.org/2000/svg",Vt=pt.createElementNS(Ft,"svg");Vt.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />',kt.test(Vt.firstChild)||Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:function(){return(new XMLSerializer).serializeToString(this)},set:function(e){var t=this.tagName.toLowerCase(),n=this.parentNode,a=avalon.parseHTML(e);if("svg"===t)n.insertBefore(a,this);else{var r=pt.createDocumentFragment();s(a,r),n.insertBefore(r,this)}n.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var e=this.outerHTML,t=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),n=new RegExp("</"+this.nodeName+">$","i");return e.replace(t,"").replace(n,"")},set:function(e){if(avalon.clearHTML){avalon.clearHTML(this);var t=avalon.parseHTML(e);s(t,this)}}}})}var zt=avalon.eventHooks;"onmouseenter"in jt||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){zt[e]={type:t,deel:function(t,n,a){return function(n){var r=n.relatedTarget;return r&&(r===t||16&t.compareDocumentPosition(r))?void 0:(delete n.type,n.type=e,a.call(t,n))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(t,n){e[t]&&!zt.animationend&&(zt.animationend={type:n})}),void 0===pt.onmousewheel&&(zt.mousewheel={type:"wheel",deel:function(e,t,n){return function(t){t.wheelDeltaY=t.wheelDelta=t.deltaY>0?-120:120,t.wheelDeltaX=0,Object.defineProperty(t,"type",{value:"mousewheel"}),n.call(e,t)}}});var Wt,Xt,Yt,Ut,qt,Gt=/[-.*+?^${}()|[\]\/\\]/g,Zt={loader:function(t){var n=mt&&t;e.require=n?mt:bt,e.define=n?mt.define:$t},interpolate:function(e){if(Wt=e[0],Xt=e[1],Wt===Xt){throw new SyntaxError("openTag!==closeTag")}var t=u(Wt),n=u(Xt);Yt=new RegExp(t+"(.*?)"+n),Ut=new RegExp(t+"(.*?)"+n,"g"),qt=new RegExp(t+".*?"+n+"|\\sms-")}};c.debug=!0,c.plugins=Zt,c.plugins.interpolate(["{{","}}"]),c.paths={},c.shim={},c.maxRepeatSize=100,avalon.config=c;var Jt=function(e){return pt.querySelectorAll(e)},Kt={$watch:function(e,t){if("function"==typeof t){var n=this.$events[e];n?n.push(t):this.$events[e]=[t]}else this.$events=this.$watch.backup;return this},$unwatch:function(e,t){var n=arguments.length;if(0===n)this.$watch.backup=this.$events,this.$events={};else if(1===n)this.$events[e]=[];else for(var a=this.$events[e]||[],r=a.length;~--r<0;)if(a[r]===t)return a.splice(r,1);return this},$fire:function(e){var t,n,a,r;/^(\w+)!(\S+)$/.test(e)&&(t=RegExp.$1,e=RegExp.$2);var i=this.$events;if(i){var o=Nt.call(arguments,1),l=[e].concat(o);if("all"===t)for(n in avalon.vmodels)a=avalon.vmodels[n],a!==this&&a.$fire.apply(a,l);else if("up"===t||"down"===t){var s=i.expr?Jt(i.expr):[];if(0===s.length)return;for(n in avalon.vmodels)if(a=avalon.vmodels[n],a!==this&&a.$events.expr){var c=Jt(a.$events.expr);if(0===c.length)continue;Ot.forEach.call(c,function(e){Ot.forEach.call(s,function(n){var r="down"===t?n.contains(e):e.contains(n);r&&(e._avalon=a)})})}var u=pt.getElementsByTagName("*"),f=[];for(Ot.forEach.call(u,function(e){e._avalon&&(f.push(e._avalon),e._avalon="",e.removeAttribute("_avalon"))}),"up"===t&&f.reverse(),n=0;(r=f[n++])&&r.$fire.apply(r,l)!==!1;);}else{var d=i[e]||[],v=i.$all||[];for(n=0;r=d[n++];)_t(r)&&r.apply(this,o);for(n=0;r=v[n++];)_t(r)&&r.apply(this,arguments)}}}},Qt=avalon.vmodels={};avalon.define=function(e,t){var a=e.$id||e;if(a||n("warning: vm必须指定$id"),Qt[a]&&n("warning: "+a+" 已经存在于avalon.vmodels中"),"object"==typeof e)var i=f(e);else{var o={$watch:r};t(o),i=f(o),wt=!0,t(i),wt=!1}return i.$id=a,Qt[a]=i};var en=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray,$proxy").match(xt),tn={value:function(e){return e in this.$model},writable:!1,enumerable:!1,configurable:!0},nn=Object.is||function(e,t){return 0===e&&0===t?1/e===1/t:e!==e?t!==t:e===t},an=function(e){var t={};for(var n in e)t[n]={get:e[n],set:e[n],enumerable:!0,configurable:!0};return t},rn=Ot.splice,on={_splice:rn,_fire:function(e,t,n){C(this.$events[yt],e,t,n)},size:function(){return this._.length},pushArray:function(e){var t=e.length,n=this.length;return t&&(Ot.push.apply(this.$model,e),$.call(this,"add",n,t,Math.max(0,n-1))),t+n},push:function(){var e,t=[],n=arguments.length;for(e=0;n>e;e++)t[e]=arguments[e];return this.pushArray(t)},unshift:function(){var e=arguments.length,t=this.length;return e&&(Ot.unshift.apply(this.$model,arguments),$.call(this,"add",0,e,0)),e+t},shift:function(){if(this.length){var e=this.$model.shift();return $.call(this,"del",0,1,0),e}},pop:function(){var e=this.length;if(e){var t=this.$model.pop();return $.call(this,"del",e-1,1,Math.max(0,e-2)),t}},splice:function(e){var t,n=arguments.length,a=[],r=rn.apply(this.$model,arguments);return r.length&&(a.push("del",e,r.length,0),t=!0),n>2&&(t?a.splice(3,1,0,"add",e,n-2):a.push("add",e,n-2,0),t=!0),t?$.apply(this,a):[]},contains:function(e){return-1!==this.indexOf(e)},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>=0?(this.$model.splice(e,1),$.call(this,"del",e,1,0)):[]},clear:function(){return this.$model.length=this.length=this._.length=0,this._fire("clear",0),this},removeAll:function(e){if(Array.isArray(e))for(var t=this.length-1;t>=0;t--)-1!==e.indexOf(this[t])&&this.removeAt(t);else if("function"==typeof e)for(t=this.length-1;t>=0;t--){var n=this[t];e(n,t)&&this.removeAt(t)}else this.clear()},ensure:function(e){return this.contains(e)||this.push(e),this},set:function(e,t){if(e>=0){var n=avalon.type(t);t&&t.$model&&(t=t.$model);var a=this[e];if("object"===n)for(var r in t)a.hasOwnProperty(r)&&(a[r]=t[r]);else"array"===n?a.clear().push.apply(a,t):a!==t&&(this[e]=t,this.$model[e]=t,this._fire("set",e,t))}return this}};"sort,reverse".replace(xt,function(e){on[e]=function(){var t,n=this.$model,a=n.concat(),r=Math.random(),i=[];Ot[e].apply(n,arguments);for(var o=0,l=a.length;l>o;o++){var s=n[o],c=a[o];if(nn(s,c))i.push(o);else{var u=a.indexOf(s);i.push(u),a[u]=r,t=!0}}return t&&(w(this,i),this._fire("move",i),this._fire("index",0)),this}});var ln=function(){var e,t=[];return{begin:function(n){t.push(e),e=n},end:function(){e=t.pop()},collectDependency:function(t,n){e&&e.callback(t,n)}}}(),sn=/^(duplex|on)$/;avalon.injectBinding=function(e){var t=e.evaluator;if(t){ln.begin({callback:function(t,n){x(t.$events[n._name],e)}});try{var n=sn.test(e.type)?e:t.apply(0,e.args);void 0===n&&delete e.evaluator,e.handler(n,e.element,e)}catch(a){delete e.evaluator;var r=e.element;if(3===r.nodeType){var i=r.parentNode;c.commentInterpolate?i.replaceChild(pt.createComment(e.value),r):r.data=Wt+(e.oneTime?"::":"")+e.value+Xt}}finally{ln.end()}}};var cn=0,un=avalon.$$subscribers=[],fn=new Date,dn={},vn={},pn=new function(){avalon.mix(this,{option:pt.createElement("select"),thead:pt.createElement("table"),td:pt.createElement("tr"),area:pt.createElement("map"),tr:pt.createElement("tbody"),col:pt.createElement("colgroup"),legend:pt.createElement("fieldset"),_default:pt.createElement("div"),g:pt.createElementNS("http://www.w3.org/2000/svg","svg")}),this.optgroup=this.option,this.tbody=this.tfoot=this.colgroup=this.caption=this.thead,this.th=this.td};String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(xt,function(e){pn[e]=pn.g});var hn=/<([\w:]+)/,mn=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,gn=i(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]),yn=pt.createElement("script"),bn=/<|&#?\w+;/;avalon.parseHTML=function(e){var t=Lt.cloneNode(!1);if("string"!=typeof e)return t;if(!bn.test(e))return t.appendChild(pt.createTextNode(e)),t;e=e.replace(mn,"<$1></$2>").trim();var n,a=(hn.exec(e)||["",""])[1].toLowerCase(),r=pn[a]||pn._default;r.innerHTML=e;var i=r.getElementsByTagName("script");if(i.length)for(var o,l=0;o=i[l++];)if(gn[o.type]){var s=yn.cloneNode(!1);Ot.forEach.call(o.attributes,function(e){s.setAttribute(e.name,e.value)}),s.text=o.text,o.parentNode.replaceChild(s,o)}for(;n=r.firstChild;)t.appendChild(n);return t},avalon.innerHTML=function(e,t){var n=this.parseHTML(t);this.clearHTML(e).appendChild(n)},avalon.clearHTML=function(e){for(e.textContent="";e.firstChild;)e.removeChild(e.firstChild);return e},"add,remove".replace(xt,function(e){avalon.fn[e+"Class"]=function(t){var n=this[0];return t&&"string"==typeof t&&n&&1===n.nodeType&&t.replace(/\S+/g,function(t){n.classList[e](t)}),this}}),avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return 1===t.nodeType&&t.classList.contains(e)},toggleClass:function(e,t){for(var n,a=0,r=String(e).split(/\s+/),i="boolean"==typeof t;n=r[a++];){var o=i?t:!this.hasClass(n);this[o?"addClass":"removeClass"](n)}return this},attr:function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},data:function(e,t){switch(e="data-"+O(e||""),arguments.length){case 2:return this.attr(e,t),this;case 1:var n=this.attr(e);return S(n);case 0:var a={};return Ot.forEach.call(this[0].attributes,function(t){t&&(e=t.name,e.indexOf("data-")||(e=N(e.slice(5)),a[e]=S(t.value)))}),a}},removeData:function(e){return e="data-"+O(e),this[0].removeAttribute(e),this},css:function(e,t){if(avalon.isPlainObject(e))for(var n in e)avalon.css(this,n,e[n]);else var a=avalon.css(this,e,t);return void 0!==a?a:this},position:function(){var e,t,n=this[0],a={top:0,left:0};if(n)return"fixed"===this.css("position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),"HTML"!==e[0].tagName&&(a=e.offset()),a.top+=avalon.css(e[0],"borderTopWidth",!0),a.left+=avalon.css(e[0],"borderLeftWidth",!0),a.top-=e.scrollTop(),a.left-=e.scrollLeft()),{top:t.top-a.top-avalon.css(n,"marginTop",!0),left:t.left-a.left-avalon.css(n,"marginLeft",!0)}},offsetParent:function(){for(var e=this[0].offsetParent;e&&"static"===avalon.css(e,"position");)e=e.offsetParent;return avalon(e||jt)},bind:function(e,t,n){return this[0]?avalon.bind(this[0],e,t,n):void 0},unbind:function(e,t,n){return this[0]&&avalon.unbind(this[0],e,t,n),this},val:function(e){var t=this[0];if(t&&1===t.nodeType){var n=0===arguments.length,a=n?":get":":set",r=Tn[D(t)+a];if(r)var i=r(t,e);else{if(n)return(t.value||"").replace(/\r/g,"");t.value=e}}return n?i:this}}),jt.dataset&&(avalon.fn.data=function(e,t){e=e&&N(e);var n=this[0].dataset;switch(arguments.length){case 2:return n[e]=t,this;case 1:return t=n[e],S(t);case 0:var r=a();for(e in n)r[e]=S(n[e]);return r}});var $n=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/;avalon.parseJSON=JSON.parse,avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){avalon.fn[e]=function(n){var a=this[0]||{},r=j(a),i="scrollTop"===e;return arguments.length?(r?r.scrollTo(i?r[t]:n,i?n:r[t]):a[e]=n,void 0):r?r[t]:a[e]}});var wn=avalon.cssHooks=a(),xn=["","-webkit-","-moz-","-ms-"],Cn={"float":"cssFloat"};avalon.cssNumber=i("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,t,n){if(Cn[e])return Cn[e];t=t||jt.style;for(var a=0,r=xn.length;r>a;a++)if(n=N(xn[a]+e),n in t)return Cn[e]=n;return null},wn["@:set"]=function(e,t,n){e.style[t]=n},wn["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,a=getComputedStyle(e);return a&&(n="filter"===t?a.getPropertyValue(t):a[t],""===n&&(n=e.style[t])),n},wn["opacity:get"]=function(e){var t=wn["@:get"](e,"opacity");return""===t?"1":t},"top,left".replace(xt,function(e){wn[e+":get"]=function(t){var n=wn["@:get"](t,e);return/px$/.test(n)?n:avalon(t).position()[e]+"px"}});var kn={position:"absolute",visibility:"hidden",display:"block"},En=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(xt,function(e){var t=e.toLowerCase(),n="client"+e,a="scroll"+e,r="offset"+e;wn[t+":get"]=function(t,n,a){var i=-4;"number"==typeof a&&(i=a),n="Width"===e?["Left","Right"]:["Top","Bottom"];
var o=t[r];return 2===i?o+avalon.css(t,"margin"+n[0],!0)+avalon.css(t,"margin"+n[1],!0):(0>i&&(o=o-avalon.css(t,"border"+n[0]+"Width",!0)-avalon.css(t,"border"+n[1]+"Width",!0)),-4===i&&(o=o-avalon.css(t,"padding"+n[0],!0)-avalon.css(t,"padding"+n[1],!0)),o)},wn[t+"&get"]=function(e){var n=[];L(e,n);for(var a,r=wn[t+":get"](e),i=0;a=n[i++];){e=a.node;for(var o in a)"string"==typeof a[o]&&(e.style[o]=a[o])}return r},avalon.fn[t]=function(i){var o=this[0];if(0===arguments.length){if(o.setTimeout)return o["inner"+e];if(9===o.nodeType){var l=o.documentElement;return Math.max(o.body[a],l[a],o.body[r],l[r],l[n])}return wn[t+"&get"](o)}return this.css(t,i)},avalon.fn["inner"+e]=function(){return wn[t+":get"](this[0],void 0,-2)},avalon.fn["outer"+e]=function(e){return wn[t+":get"](this[0],void 0,e===!0?2:0)}}),avalon.fn.offset=function(){var e=this[0];try{var t=e.getBoundingClientRect();if(t.width||t.height||e.getClientRects().length){var n=e.ownerDocument,a=n.documentElement,r=n.defaultView;return{top:t.top+r.pageYOffset-a.clientTop,left:t.left+r.pageXOffset-a.clientLeft}}}catch(i){return{left:0,top:0}}};var Tn={"select:get":function(e,t){for(var n,a=e.options,r=e.selectedIndex,i="select-one"===e.type||0>r,o=i?null:[],l=i?r+1:a.length,s=0>r?l:i?r:0;l>s;s++)if(n=a[s],(n.selected||s===r)&&!n.disabled){if(t=n.value,i)return t;o.push(t)}return o},"select:set":function(e,t,n){t=[].concat(t);for(var a,r=0;a=e.options[r++];)(a.selected=t.indexOf(a.value)>-1)&&(n=!0);n||(e.selectedIndex=-1)}},An=JSON.stringify,Mn=["break,case,catch,continue,debugger,default,delete,do,else,false","finally,for,function,if,in,instanceof,new,null,return,switch,this","throw,true,try,typeof,var,void,while,with","abstract,boolean,byte,char,class,const,double,enum,export,extends","final,float,goto,implements,import,int,interface,long,native","package,private,protected,public,short,static,super,synchronized","throws,transient,volatile","arguments,let,yield,undefined"].join(","),On=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,Nn=/[^\w$]+/g,Sn=new RegExp(["\\b"+Mn.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),jn=/\b\d[^,]*/g,Ln=/^,+|,+$/g,Dn=new Bt(512),Hn=function(e){var t=","+e.trim(),n=Dn.get(t);if(n)return n;var a=e.replace(On,"").replace(Nn,",").replace(Sn,"").replace(jn,"").replace(Ln,"").split(/^$|,+/);return Dn.put(t,P(a))},Pn=new Bt(128),_n=/\w\[.*\]|\w\.\w/,In=/(\$proxy\$[a-z]+)\d+$/,Rn=/\)\s*$/,Bn=/\)\s*\|/g,Fn=/\|\s*([$\w]+)/g,Vn=/"\s*\["/g,zn=/"\s*\(/g;avalon.parseExprProxy=R,avalon.scan=function(e,t){e=e||jt;var n=t?[].concat(t):[];U(e,n)};var Wn=i("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase()),Xn=function(e,t,n){var a=e.getAttribute(t);if(a)for(var r,i=0;r=n[i++];)if(r.hasOwnProperty(a)&&"function"==typeof r[a])return r[a]},Yn=Pt&&e.MutationObserver?function(e){for(var t,n=e.firstChild;n;){var a=n.nextSibling;3===n.nodeType?t?(t.nodeValue+=n.nodeValue,e.removeChild(n)):t=n:t=null,n=a}}:0,Un=/^\s*::/,qn=/ms-(\w+)-?(.*)/,Gn={"if":10,repeat:90,data:100,widget:110,each:1400,"with":1500,duplex:2e3,on:3e3},Zn=i("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),Jn=i("value,title,alt,checked,selected,disabled,readonly,enabled"),Kn=/^if|widget|repeat$/,Qn=/^each|with|html|include$/,ea=/\|\s*html(?:\b|$)/,ta=/\|\|/g,na=/(['"])(\\\1|.)+?\1/g,aa=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected","contentEditable,isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(","),ra={};aa.replace(xt,function(e){ra[e.toLowerCase()]=e});var ia={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},oa=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight","rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");oa.replace(xt,function(e){ia[e.toLowerCase()]=e});var la=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/gim,sa=/<noscript.*?>([\s\S]+?)<\/noscript>/im,ca=function(){return new(e.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},ua=avalon.templateCache={};It.attr=function(e,t){var n=e.value.trim(),a=!0;if(n.indexOf(Wt)>-1&&n.indexOf(Xt)>2&&(a=!1,Yt.test(n)&&""===RegExp.rightContext&&""===RegExp.leftContext&&(a=!0,n=RegExp.$1)),"include"===e.type){var r=e.element;e.includeRendered=Xn(r,"data-include-rendered",t),e.includeLoaded=Xn(r,"data-include-loaded",t);var i=e.includeReplace=!!avalon(r).data("includeReplace");avalon(r).data("includeCache")&&(e.templateCache={}),e.startInclude=pt.createComment("ms-include"),e.endInclude=pt.createComment("ms-include-end"),i?(e.element=e.startInclude,r.parentNode.insertBefore(e.startInclude,r),r.parentNode.insertBefore(e.endInclude,r.nextSibling)):(r.insertBefore(e.startInclude,r.firstChild),r.appendChild(e.endInclude))}e.handlerName="attr",R(n,t,e,a?0:G(e.value))},Rt.attr=function(t,n,a){var r=a.type,i=a.param;if("css"===r)avalon(n).css(i,t);else if("attr"===r){var o=t===!1||null===t||void 0===t;!St&&ia[i]&&(i=ia[i]);var l=ra[i];if("boolean"==typeof n[l]&&(n[l]=!!t,t||(o=!0)),o)return n.removeAttribute(i);var s=kt.test(n)?!1:pt.namespaces&&isVML(n)?!0:i in n.cloneNode(!1);s?n[i]=t+"":n.setAttribute(i,t)}else if("include"===r&&t){var c=a.vmodels,u=a.includeRendered,f=a.includeLoaded,d=a.includeReplace,v=d?n.parentNode:n,p=function(e){if(f){var n=f.apply(v,[e].concat(c));"string"==typeof n&&(e=n)}u&&B(v,function(){u.call(v)},0/0);var r=a.includeLastID;if(a.templateCache&&r&&r!==t){var i=a.templateCache[r];i||(i=a.templateCache[r]=pt.createElement("div"),gt.appendChild(i))}for(a.includeLastID=t;;){var o=a.startInclude.nextSibling;if(!o||o===a.endInclude)break;v.removeChild(o),i&&i.appendChild(o)}var l=J(a,t,e),s=avalon.slice(l.childNodes);v.insertBefore(l,a.endInclude),Y(s,c)};if("src"===a.param)if("string"==typeof ua[t])avalon.nextTick(function(){p(ua[t])});else if(Array.isArray(ua[t]))ua[t].push(p);else{var h=ca();h.onreadystatechange=function(){if(4===h.readyState){var e=h.status;if(e>=200&&300>e||304===e||1223===e){for(var n,a=h.responseText,r=0;n=ua[t][r++];)n(a);ua[t]=a}}},ua[t]=[p],h.open("GET",t,!0),"withCredentials"in h&&(h.withCredentials=!0),h.setRequestHeader("X-Requested-With","XMLHttpRequest"),h.send(null)}else{var m=t&&1===t.nodeType?t:pt.getElementById(t);if(m){if("NOSCRIPT"===m.tagName&&!m.innerHTML&&!m.fixIE78){h=ca(),h.open("GET",location,!1),h.send(null);for(var g=pt.getElementsByTagName("noscript"),y=(h.responseText||"").match(la)||[],b=y.length,$=0;b>$;$++){var w=g[$];w&&(w.style.display="none",w.fixIE78=(y[$].match(sa)||["","&nbsp;"])[1])}}avalon.nextTick(function(){p(m.fixIE78||m.value||m.innerText||m.innerHTML)})}}}else if(jt.hasAttribute||"string"!=typeof t||"src"!==r&&"href"!==r||(t=t.replace(/&amp;/g,"&")),n[r]=t,e.chrome&&"EMBED"===n.tagName){var x=n.parentNode,C=document.createComment("ms-src");x.replaceChild(C,n),x.replaceChild(n,C)}},"title,alt,src,value,css,include,href".replace(xt,function(e){It[e]=It.attr}),It["class"]=function(e,t){var a,r=e.param,i=e.value;if(e.handlerName="class",!r||isFinite(r)){e.param="";var o=i.replace(Ut,function(e){return e.replace(/./g,"0")}),l=o.indexOf(":");if(-1===l)var s=i;else{if(s=i.slice(0,l),a=i.slice(l+1),I(a,t,e),!e.evaluator)return n("debug: ms-class '"+(a||"").trim()+"' 不存在于VM中"),!1;e._evaluator=e.evaluator,e._args=e.args}var c=Yt.test(s);c||(e.immobileClass=s),R("",t,e,c?G(s):0)}else e.immobileClass=e.oldStyle=e.param,R(i,t,e)},Rt["class"]=function(e,t,n){var a=avalon(t),r=n.type;if("class"===r&&n.oldStyle)a.toggleClass(n.oldStyle,!!e);else switch(n.toggleClass=n._evaluator?!!n._evaluator.apply(t,n._args):!0,n.newClass=n.immobileClass||e,n.oldClass&&n.newClass!==n.oldClass&&a.removeClass(n.oldClass),n.oldClass=n.newClass,r){case"class":a.toggleClass(n.newClass,n.toggleClass);break;case"hover":case"active":if(!n.hasBindEvent){var i="mouseenter",o="mouseleave";if("active"===r){t.tabIndex=t.tabIndex||-1,i="mousedown",o="mouseup";var l=a.bind("mouseleave",function(){n.toggleClass&&a.removeClass(n.newClass)})}var s=a.bind(i,function(){n.toggleClass&&a.addClass(n.newClass)}),c=a.bind(o,function(){n.toggleClass&&a.removeClass(n.newClass)});n.rollback=function(){a.unbind("mouseleave",l),a.unbind(i,s),a.unbind(o,c)},n.hasBindEvent=!0}}},"hover,active".replace(xt,function(e){It[e]=It["class"]}),Rt.data=function(e,t,n){var a="data-"+n.param;e&&"object"==typeof e?t[a]=e:t.setAttribute(a,String(e))};var fa=It.duplex=function(e,t){var a,o=e.element;if(R(e.value,t,e,0,1),e.changed=Xn(o,"data-duplex-changed",t)||r,e.evaluator&&e.args){var l=[],s=i("string,number,boolean,checked");"radio"===o.type&&""===e.param&&(e.param="checked"),o.msData&&(o.msData["ms-duplex"]=e.value),e.param.replace(/\w+/g,function(t){/^(checkbox|radio)$/.test(o.type)&&/^(radio|checked)$/.test(t)&&("radio"===t&&n("ms-duplex-radio已经更名为ms-duplex-checked"),t="checked",e.isChecked=!0),"bool"===t?(t="boolean",n("ms-duplex-bool已经更名为ms-duplex-boolean")):"text"===t&&(t="string",n("ms-duplex-text已经更名为ms-duplex-string")),s[t]&&(a=!0),avalon.Array.ensure(l,t)}),a||l.push("string"),e.param=l.join("-"),e.bound=function(t,n){o.addEventListener?o.addEventListener(t,n,!1):o.attachEvent("on"+t,n);var a=e.rollback;e.rollback=function(){o.avalonSetter=null,avalon.unbind(o,t,n),a&&a()}};for(var c in avalon.vmodels){var u=avalon.vmodels[c];u.$fire("avalon-ms-duplex-init",e)}var f=e.pipe||(e.pipe=Q);f(null,e,"init");var d=o.tagName;fa[d]&&fa[d](o,e.evaluator.apply(null,e.args),e)}};avalon.duplexHooks={checked:{get:function(e,t){return!t.element.oldValue}},string:{get:function(e){return e},set:K},"boolean":{get:function(e){return"true"===e},set:K},number:{get:function(e,t){var n=parseFloat(e);if(-e===-n)return n;var a=/strong|medium|weak/.exec(t.element.getAttribute("data-duplex-number"))||["medium"];switch(a[0]){case"strong":return 0;case"medium":return""===e?"":0;case"weak":return e}},set:K}};var da,va=[];avalon.tick=function(e){1===va.push(e)&&(da=setInterval(et,60))};var pa=r,ha=/text|password|hidden/;!new function(){function e(e){t[this.tagName].call(this,e),ha.test(this.type)&&!this.msFocus&&this.avalonSetter&&this.avalonSetter()}try{var t={},n=HTMLInputElement.prototype,a=HTMLTextAreaElement.prototype,r=HTMLInputElement.prototype;Object.getOwnPropertyNames(r),t.INPUT=Object.getOwnPropertyDescriptor(n,"value").set,Object.defineProperty(n,"value",{set:e}),t.TEXTAREA=Object.getOwnPropertyDescriptor(a,"value").set,Object.defineProperty(a,"value",{set:e})}catch(i){pa=avalon.tick}},fa.INPUT=function(e,t,a){function r(e){a.changed.call(this,e,a)}function i(){u=!0}function o(){u=!1}var l=e.type,s=a.bound,c=avalon(e),u=!1,f=function(){if(!u){var n=e.oldValue=e.value,i=a.pipe(n,a,"get");c.data("duplexObserve")!==!1&&(t(i),r.call(e,i),c.data("duplex-focus")&&avalon.nextTick(function(){e.focus()}))}};if(a.handler=function(){var n=a.pipe(t(),a,"set")+"";n!==e.oldValue&&(e.value=n)},a.isChecked||"radio"===l)f=function(){if(c.data("duplexObserve")!==!1){var n=a.pipe(e.value,a,"get");t(n),r.call(e,n)}},a.handler=function(){var n=t(),r=a.isChecked?!!n:n+""===e.value;e.checked=e.oldValue=r},s("click",f);else if("checkbox"===l)f=function(){if(c.data("duplexObserve")!==!1){var i=e.checked?"ensure":"remove",o=t();Array.isArray(o)||(n("ms-duplex应用于checkbox上要对应一个数组"),o=[o]),avalon.Array[i](o,a.pipe(e.value,a,"get")),r.call(e,o)}},a.handler=function(){var n=[].concat(t());e.checked=n.indexOf(a.pipe(e.value,a,"get"))>-1},s("change",f);else{var d=e.getAttribute("data-duplex-event")||"input";e.attributes["data-event"]&&n("data-event指令已经废弃，请改用data-duplex-event"),d.replace(xt,function(e){switch(e){case"input":s("input",f),s("DOMAutoComplete",f),Pt||(s("compositionstart",i),s("compositionend",o));break;default:s(e,f)}}),s("focus",function(){e.msFocus=!0}),s("blur",function(){e.msFocus=!1}),ha.test(l)&&pa(function(){if(jt.contains(e))e.msFocus||e.oldValue===e.value||f();else if(!e.msRetain)return!1}),e.avalonSetter=f}e.oldValue=e.value,avalon.injectBinding(a),r.call(e,e.value)},fa.TEXTAREA=fa.INPUT,fa.SELECT=function(e,t,a){function r(){if(i.data("duplexObserve")!==!1){var n=i.val();n=Array.isArray(n)?n.map(function(e){return a.pipe(e,a,"get")}):a.pipe(n,a,"get"),n+""!==e.oldValue&&t(n),a.changed.call(e,n,a)}}var i=avalon(e);a.handler=function(){var a=t();a=a&&a.$model||a,Array.isArray(a)?e.multiple||n("ms-duplex在<select multiple=true>上要求对应一个数组"):e.multiple&&n("ms-duplex在<select multiple=false>不能对应一个数组"),a=Array.isArray(a)?a.map(String):a+"",a+""!==e.oldValue&&(i.val(a),e.oldValue=a+"")},a.bound("change",r),e.msCallback=function(){avalon.injectBinding(a),a.changed.call(e,t(),a)}},Rt.html=function(e,t,n){var a=1!==t.nodeType,r=a?t.parentNode:t;if(r&&(e=null==e?"":e,n.oldText!==e)){if(n.oldText=e,3===t.nodeType){var i=Ht("html");r.insertBefore(pt.createComment(i),t),n.element=pt.createComment(i+":end"),r.replaceChild(n.element,t),t=n.element}if("object"!=typeof e)var o=avalon.parseHTML(String(e));else if(11===e.nodeType)o=e;else if(1===e.nodeType||e.item){var l=1===e.nodeType?e.childNodes:e.item;for(o=Lt.cloneNode(!0);l[0];)o.appendChild(l[0])}if(l=avalon.slice(o.childNodes),a){for(var s=t.nodeValue.slice(0,-4);;){var c=t.previousSibling;if(!c||8===c.nodeType&&c.nodeValue===s)break;r.removeChild(c)}r.insertBefore(o,t)}else avalon.clearHTML(t).appendChild(o);Y(l,n.vmodels)}},It["if"]=It.data=It.text=It.html=function(e,t){R(e.value,t,e)},Rt["if"]=function(e,t,n){try{if(!t.parentNode)return}catch(a){return}if(e)8===t.nodeType&&(t.parentNode.replaceChild(n.template,t),t=n.element=n.template),t.getAttribute(n.name)&&(t.removeAttribute(n.name),W(t,n.vmodels)),n.rollback=null;else if(1===t.nodeType){var r=n.element=pt.createComment("ms-if");t.parentNode.replaceChild(r,t),n.template=t,gt.appendChild(t),n.rollback=function(){t.parentNode===gt&&gt.removeChild(t)}}};var ma=/\(([^)]*)\)/;It.on=function(e,t){var n=e.value;e.type="on";var a=e.param.replace(/-\d+$/,"");if("function"==typeof It.on[a+"Hook"]&&It.on[a+"Hook"](e),n.indexOf("(")>0&&n.indexOf(")")>-1){var r=(n.match(ma)||["",""])[1].trim();(""===r||"$event"===r)&&(n=n.replace(ma,""))}R(n,t,e)},Rt.on=function(e,t,n){e=function(e){var t=n.evaluator||r;return t.apply(this,n.args.concat(e))};var a=n.param.replace(/-\d+$/,"");if("scan"===a)e.call(t,{type:a});else if("function"==typeof n.specialBind)n.specialBind(t,e);else var i=avalon.bind(t,a,e);n.rollback=function(){"function"==typeof n.specialUnbind?n.specialUnbind():avalon.unbind(t,a,i)}},It.repeat=function(e,t){var n=e.type;R(e.value,t,e,0,1),e.proxies=[];var a=!1;try{var r=e.$repeat=e.evaluator.apply(0,e.args||[]),i=avalon.type(r);"object"!==i&&"array"!==i&&(a=!0,avalon.log("warning:"+e.value+"只能是对象或数组"))}catch(o){a=!0}var l=e.value.split(".")||[];if(l.length>1){l.pop();for(var s,c=l[0],u=0;s=t[u++];)if(s&&s.hasOwnProperty(c)){var f=s[c].$events||{};f[yt]=f[yt]||[],f[yt].push(e);break}}var d=e.element;if(1===d.nodeType){d.removeAttribute(e.name),e.sortedCallback=Xn(d,"data-with-sorted",t),e.renderedCallback=Xn(d,"data-"+n+"-rendered",t);var v=Ht(n),p=pt.createComment(v),h=pt.createComment(v+":end");if(e.signature=v,e.template=Lt.cloneNode(!1),"repeat"===n){var m=d.parentNode;m.replaceChild(h,d),m.insertBefore(p,h),e.template.appendChild(d)}else{for(;d.firstChild;)e.template.appendChild(d.firstChild);d.appendChild(p),d.appendChild(h)}e.element=h,e.handler=Rt.repeat,e.rollback=function(){var t=e.element;t&&e.handler("clear")}}if(!a){e.$outer={};var g="$key",y="$val";for(Array.isArray(r)&&(g="$first",y="$last"),u=0;s=t[u++];)if(s.hasOwnProperty(g)&&s.hasOwnProperty(y)){e.$outer=s;break}var b=r.$events,$=(b||{})[yt];x($,e),"object"===i?(e.$with=!0,r.$proxy||(r.$proxy={}),e.handler("append",r)):r.length&&e.handler("add",0,r.length)}},Rt.repeat=function(e,t,n){if(!e&&this.$with){e="append";var a="update"}if(e){var i,o,l=this,s=l.element,c=nt(l),u=s.parentNode,f=l.proxies,d=Lt.cloneNode(!1);switch(e){case"add":for(var v=t+n,p=[],h=t;v>h;h++){var m=ct(h,l);f.splice(h,0,m),tt(l,d,m,p)}var g=new Date-0;for(avalon.optimize=avalon.optimize||g,h=0;o=p[h++];)Y(o.nodes,o.vmodels),o.nodes=o.vmodels=null;avalon.optimize===g&&(avalon.optimize=null),u.insertBefore(d,c[t]||s),avalon.profile("插入操作花费了 "+(new Date-g));break;case"del":at(c[t],c[t+n]||s);var y=f.splice(t,n);ot(y,"each");break;case"clear":i=c[0],i&&(at(i,s),l.$with&&u.insertBefore(i,s)),ot(f,"each");break;case"move":if(i=c[0]){var b,$=i.nodeValue,x=[],k=[];for(at(i,s,function(){k.unshift(this),this.nodeValue===$&&(x.unshift(k),k=[])}),w(x,t),w(f,t);k=x.shift();)for(;b=k.shift();)d.appendChild(b);u.insertBefore(d,s)}break;case"index":for(var E=f.length-1;n=f[t];t++)n.$index=t,n.$first=0===t,n.$last=t===E;return;case"set":m=f[t],m&&C(m.$events[l.param||"el"]);break;case"append":var T=l.$repeat,A=T.$proxy,M=[];g=new Date-0,avalon.optimize=avalon.optimize||g,"update"===a&&(l.evaluator||R(l.value,l.vmodels,l,0,1),T=l.$repeat=l.evaluator.apply(0,l.args||[]),T.$proxy=A);var O=T.$proxy||{};y=[];var N=l.element.parentNode.childNodes,S=!1;for(h=0;b=N[h++];)b.nodeValue===l.signature?S=!0:b.nodeValue===l.signature+":end"&&(S=!1),S&&y.push(b);var j,L=[],D=l.keyIndex||(l.keyIndex={});for(h=0;h<y.length;h++)n=y[h],n.nodeValue===l.signature&&(j=Lt.cloneNode(!1),L.push(j)),j.appendChild(n);for(var H in T)T.hasOwnProperty(H)&&"hasOwnProperty"!==H&&"$proxy"!==H&&M.push(H);for(var h=0;H=M[h++];)O.hasOwnProperty(H)?O[H].$val=T[H]:O[H]=it(O[H],H,l);for(H in O)-1===M.indexOf(H)&&(ut(O[H],ga),delete O[H]);var p=[],P=M,s=l.element;if(l.sortedCallback){var _=l.sortedCallback.call(u,M);_&&Array.isArray(_)&&(P=_)}for(h=0;h<P.length;h++)H=P[h],"number"==typeof D[H]?(d.appendChild(L[D[H]]),p.push({})):tt(l,d,O[H],p);for(h=0;h<P.length;h++)D[P[h]]=h;for(h=0;o=p[h++];)o.nodes&&(Y(o.nodes,o.vmodels),o.nodes=o.vmodels=null);avalon.optimize===g&&(avalon.optimize=null),u.insertBefore(d,s),avalon.profile("插入操作花费了 "+(new Date-g))}if(!l.$repeat||l.$repeat.hasOwnProperty("$lock"))return;"clear"===e&&(e="del");var I=l.renderedCallback||r,B=arguments;u.oldValue&&"SELECT"===u.tagName&&avalon(u).val(u.oldValue.split(",")),I.apply(u,B)}},"with,each".replace(xt,function(e){It[e]=It.repeat});var ga=[],ya=[];Rt.text=function(e,t){if(e=null==e?"":e,3===t.nodeType)try{t.data=e}catch(n){}else t.textContent=e},avalon.parseDisplay=ft,It.visible=function(e,t){var n=e.element,a=n.style.display;"none"===a&&(a=ft(n.nodeName)),e.display=a,R(e.value,t,e)},Rt.visible=function(e,t,n){t.style.display=e?n.display:"none"},It.widget=function(t,a){var i=t.value.match(xt),o=t.element,l=i[0],s=i[1];s&&"$"!==s||(s=Ht(l));var c=i[2]||l,u=avalon.ui[l];if("function"==typeof u){a=o.vmodels||a;for(var f,d=0;f=a[d++];)if(f.hasOwnProperty(c)&&"object"==typeof f[c]){var v=f[c];v=v.$model||v;break}if(v){var p=v[l+"Id"];"string"==typeof p&&(n("warning!不再支持"+l+"Id"),s=p)}var h=avalon.getWidgetData(o,l);t.value=[l,s,c].join(","),t[l+"Id"]=s,t.evaluator=r,o.msData["ms-widget-id"]=s;var m=t[l+"Options"]=avalon.mix({},u.defaults,v||{},h);o.removeAttribute("ms-widget");var g=u(o,t,a)||{};if(g.$id){avalon.vmodels[s]=g,F(o,g);try{g.$init(function(){avalon.scan(o,[g].concat(a)),"function"==typeof m.onInit&&m.onInit.call(o,g,m,a)})}catch(y){}t.rollback=function(){try{g.widgetElement=null,g.$remove()}catch(e){}o.msData={},delete avalon.vmodels[g.$id]},E(t,ba),e.chrome&&o.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(T)})}else avalon.scan(o,a)}else a.length&&(o.vmodels=a)};var ba=[],$a=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,wa=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,xa=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,Ca={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi},ka=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ea=/([^\#-~| |!])/g,Ta=avalon.filters={uppercase:function(e){return e.toUpperCase()},lowercase:function(e){return e.toLowerCase()},truncate:function(e,t,n){return t=t||30,n="string"==typeof n?n:"...",e.length>t?e.slice(0,t-n.length)+n:String(e)},$filter:function(e){for(var t=1,n=arguments.length;n>t;t++){var a=arguments[t],r=avalon.filters[a.shift()];if("function"==typeof r){var i=[e].concat(a);e=r.apply(null,i)}}return e},camelize:N,sanitize:function(e){return e.replace($a,"").replace(xa,function(e){var t=e.toLowerCase().match(/<(\w+)\s/);if(t){var n=Ca[t[1]];n&&(e=e.replace(n,function(e,t,n){var a=n.charAt(0);return t+"="+a+"javascript:void(0)"+a}))}return e.replace(wa," ").replace(/\s+/g," ")})},escape:function(e){return String(e).replace(/&/g,"&amp;").replace(ka,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+(1024*(t-55296)+(n-56320)+65536)+";"}).replace(Ea,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(e,t,n){return(t||"￥")+dt(e,isFinite(n)?n:2)},number:dt};!new function(){function e(e){return parseInt(e,10)||0}function t(e,t,n){var a="";for(0>e&&(a="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),a+e}function n(e,n,a,r){return function(i){var o=i["get"+e]();return(a>0||o>-a)&&(o+=a),0===o&&-12===a&&(o=12),t(o,n,r)}}function a(e,t){return function(n,a){var r=n["get"+e](),i=(t?"SHORT"+e:e).toUpperCase();return a[i][r]}}function r(e){var n=-1*e.getTimezoneOffset(),a=n>=0?"+":"";return a+=t(Math[n>0?"floor":"ceil"](n/60),2)+t(Math.abs(n%60),2)}function i(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}var o={yyyy:n("FullYear",4),yy:n("FullYear",2,0,!0),y:n("FullYear",1),MMMM:a("Month"),MMM:a("Month",!0),MM:n("Month",2,1),M:n("Month",1,1),dd:n("Date",2),d:n("Date",1),HH:n("Hours",2),H:n("Hours",1),hh:n("Hours",2,-12),h:n("Hours",1,-12),mm:n("Minutes",2),m:n("Minutes",1),ss:n("Seconds",2),s:n("Seconds",1),sss:n("Milliseconds",3),EEEE:a("Day"),EEE:a("Day",!0),a:i,Z:r},l=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,s=/^\/Date\((\d+)\)\/$/;Ta.date=function(t,n){var a,r,i=Ta.date.locate,c="",u=[];if(n=n||"mediumDate",n=i[n]||n,"string"==typeof t)if(/^\d+$/.test(t))t=e(t);else if(s.test(t))t=+RegExp.$1;else{var f=t.trim(),d=[0,0,0,0,0,0,0],v=new Date(0);f=f.replace(/^(\d+)\D(\d+)\D(\d+)/,function(t,n,a,r){var i=4===r.length?[r,n,a]:[n,a,r];return d[0]=e(i[0]),d[1]=e(i[1])-1,d[2]=e(i[2]),""});var p=v.setFullYear,h=v.setHours;f=f.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(t,n,a,r,i){return d[3]=e(n),d[4]=e(a),d[5]=e(r),i&&(d[6]=Math.round(1e3*parseFloat("0."+i))),""});var m=0,g=0;f=f.replace(/Z|([+-])(\d\d):?(\d\d)/,function(t,n,a,r){return p=v.setUTCFullYear,h=v.setUTCHours,n&&(m=e(n+a),g=e(n+r)),""}),d[3]-=m,d[4]-=g,p.apply(v,d.slice(0,3)),h.apply(v,d.slice(3)),t=v}if("number"==typeof t&&(t=new Date(t)),"date"===avalon.type(t)){for(;n;)r=l.exec(n),r?(u=u.concat(r.slice(1)),n=u.pop()):(u.push(n),n=null);return u.forEach(function(e){a=o[e],c+=a?a(t,i):e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}};var c={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};c.SHORTMONTH=c.MONTH,Ta.date.locate=c},new function(){function e(e){for(a=1;e=n.shift();)e()}avalon.config({loader:!1});var t,n=[],a="complete"===pt.readyState;avalon.bind(pt,"DOMContentLoaded",t=function(){avalon.unbind(pt,"DOMContentLoaded",t),e()});var r=setInterval(function(){"complete"===document.readyState&&document.body&&(clearInterval(r),e())},50);avalon.ready=function(e){a?e(avalon):n.push(e)},avalon.ready(function(){avalon.scan(pt.body)})},new function(){function t(e){return("touch"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_TOUCH)&&e.isPrimary}function n(e,t){return e.type==="pointer"+t||e.type.toLowerCase()==="mspointer"+t}function a(e,t,n,a){return Math.abs(e-t)>=Math.abs(n-a)?e-t>0?"left":"right":n-a>0?"up":"down"}function r(e){var t=e.touches&&e.touches.length?e.touches:[e],n=e.changedTouches?e.changedTouches[0]:t[0];return{x:n.clientX,y:n.clientY}}function i(e,t,n){var a=document.createEvent("Events");a.initEvent(t,!0,!0),a.fireByAvalon=!0,n&&(a.detail=n),e.dispatchEvent(a)}function o(e){return e.fireByAvalon?!0:(h.element&&"select"!==e.target.tagName.toLowerCase()&&(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),"click"===e.type&&(h.element=null)),void 0)}function l(){w&&clearTimeout(w),w=null}function s(e){var a=n(e,"down"),o=a?e:e.touches&&e.touches[0]||e,l="tagName"in o.target?o.target:o.target.parentNode,s=Date.now(),c=s-(h.last||s);if(!a||t(e))return avalon.mix(h,r(e)),h.mx=0,h.my=0,c>0&&250>=c&&(h.isDoubleTap=!0),h.last=s,h.element=l,avalon(l).addClass(x.activeClass),w=setTimeout(function(){w=null,i(l,"hold"),i(l,"longtap"),h={},avalon(l).removeClass(x.activeClass)},x.clickDuration),!0}function c(e){var a=n(e,"down"),i=r(e);d&&Math.abs(h.x-i.x)>10&&e.preventDefault(),(!a||t(e))&&(l(),h.mx+=Math.abs(h.x-i.x),h.my+=Math.abs(h.y-i.y))}function u(e){var o=n(e,"down");if(element=h.element,(!o||t(e))&&element){l();var s=r(e),c=Math.abs(h.x-s.x),u=Math.abs(h.y-s.y);if(c>30||u>30){var f=a(h.x,s.x,h.y,s.y),d={direction:f};i(element,"swipe",d),i(element,"swipe"+f,d),avalon(element).removeClass(x.activeClass),h={},h.element=element}else if(x.canClick(element)&&h.mx<x.dragDistance&&h.my<x.dragDistance){document.activeElement&&document.activeElement!==element&&document.activeElement.blur();var v;"label"===element.tagName.toLowerCase()&&(v=element.htmlFor?document.getElementById(element.htmlFor):null),v?x.focus(v):x.focus(element),"select"!==e.target.tagName.toLowerCase()&&e.preventDefault(),i(element,"tap"),avalon.fastclick.fireEvent(element,"click",e),avalon(element).removeClass(x.activeClass),h.isDoubleTap?(i(element,"doubletap"),avalon.fastclick.fireEvent(element,"dblclick",e),h={},avalon(element).removeClass(x.activeClass),h.element=element):$=setTimeout(function(){clearTimeout($),$=null,h={},avalon(element).removeClass(x.activeClass),h.element=element},250)}}}var f=navigator.userAgent,d=f.indexOf("Android")>0,v=/iP(ad|hone|od)/.test(f),p=It.on,h={},m=navigator.pointerEnabled,g=navigator.msPointerEnabled,y=function(){var e=v||!1;try{var t=document.createElement("div");t.ontouchstart=function(){e=!0};var n=document.createEvent("TouchEvent");n.initUIEvent("touchstart",!0,!0),t.dispatchEvent(n)}catch(a){}return t=t.ontouchstart=null,e}(),b=["mousedown","mousemove","mouseup",""];y?b=["touchstart","touchmove","touchend","touchcancel"]:m?b=["pointerdown","pointermove","pointerup","pointercancel"]:g&&(b=["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerCancel"]);var $,w;document.addEventListener("mousedown",o,!0),document.addEventListener("click",o,!0),document.addEventListener(b[0],s),document.addEventListener(b[1],c),document.addEventListener(b[2],u),b[3]&&document.addEventListener(b[3],function(){w&&clearTimeout(w),$&&clearTimeout($),w=$=null,h={}});var x=avalon.fastclick={activeClass:"ms-click-active",clickDuration:750,dragDistance:30,fireEvent:function(t,n,a){var r=document.createEvent("MouseEvents");r.initMouseEvent(n,!0,!0,e,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null),Object.defineProperty(r,"fireByAvalon",{value:!0}),t.dispatchEvent(r)},focus:function(e){if(this.canFocus(e)){var t=e.value;if(e.value=t,v&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type){var n=t.length;e.setSelectionRange(n,n)}else e.focus()}},canClick:function(e){switch(e.nodeName.toLowerCase()){case"textarea":case"select":case"input":return!e.disabled;default:return!0}},canFocus:function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!d;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return!1}}};["swipe","swipeleft","swiperight","swipeup","swipedown","doubletap","tap","dblclick","longtap","hold"].forEach(function(e){p[e+"Hook"]=p.clickHook})},"function"==typeof define&&define.amd&&define("avalon",[],function(){return avalon});var Aa=e.avalon;return avalon.noConflict=function(t){return t&&e.avalon===avalon&&(e.avalon=Aa),avalon},void 0===t&&(e.avalon=avalon),avalon});
Number.prototype.add=function(e){var t,o,n;try{o=this.toString().split(".")[1].length}catch(i){o=0}try{n=e.toString().split(".")[1].length}catch(i){n=0}return t=Math.pow(10,Math.max(o,n)),(this*t+e*t)/t},Number.prototype.sub=function(e){return this.add(-e)},Number.prototype.mul=function(e){var t=0,o=this.toString(),n=e.toString();try{t+=o.split(".")[1].length}catch(i){}try{t+=n.split(".")[1].length}catch(i){}return Number(o.replace(".",""))*Number(n.replace(".",""))/Math.pow(10,t)},Number.prototype.div=function(e){var t,o,n=0,i=0;try{n=this.toString().split(".")[1].length}catch(a){}try{i=e.toString().split(".")[1].length}catch(a){}return t=Number(this.toString().replace(".","")),o=Number(e.toString().replace(".","")),t/o*Math.pow(10,i-n)};var B={};B.url={},B.url.getParam=function(e,t){t=t||location.href;var o=new RegExp("(^|&|\\?|#)"+e+"=([^&]*?)(&|#|$)"),n=t.match(/#.*/)?t.match(/#.*/)[0]:"";return t=t.replace(/#.*/,""),o.test(n)?decodeURIComponent(n.match(o)[2]):o.test(t)?decodeURIComponent(t.match(o)[2]):""},B.url.setParam=function(e,t,o,n){if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof o)return o;var i,a=new RegExp("(^|&|\\?|#)"+e+"=([^&]*?)(&|#|$)"),r=o.match(/#.*/)?o.match(/#.*/)[0]:"";return o=o.replace(/#.*/,""),n===!0?(a.test(r)?r=r.replace(a,function(o,n,i,a){return n+e+"="+encodeURIComponent(t)+a}):(i=-1===r.indexOf("#")?"#":"&",r=r+i+e+"="+encodeURIComponent(t)),r=r.replace(a,function(o,n,i,a){return n+e+"="+encodeURIComponent(t)+a}),r+o):(a.test(o)?o=o.replace(a,function(o,n,i,a){return n+e+"="+encodeURIComponent(t)+a}):(i=-1===o.indexOf("?")?"?":"&",o=o+i+e+"="+encodeURIComponent(t)),o+r)},B.url.parseHash=function(e){var t,o,n={},i=e.split("?");if(t=i[0],i.length>1){var a,r;o=i[1],a=o.split("&");for(var d=0;d<a.length;d++)a[d]&&(r=a[d].split("="),n[r[0]]=r[1])}return{hash:e,tag:t,query:o,param:n}},B.url.getObj=function(e){var t=B.url.parseHash(e);return t.param},B.url.setObj=function(e,t){return $.each(t,function(t,o){e=B.url.setParam(t,o,e)}),e},B.user={},B.user.isLogin=function(){return!!(ddb.cookie("wx_user_id")&&ddb.cookie("wx_mobile")&&ddb.cookie("wx_device_id"))},B.user.login=function(e){e=e||location.href,location=B.url.setParam("referrer",e,"../tpl/login.html")},B.user.logout=function(e){var t=ddb.isWeixin?"/v2/app/userLoginOut/":"authentication/logout",o=ddb.isWeixin?{urlType:"app"}:{};ddb.get(t,o,function(t){if(0===+t.ret){if(ddb.cookie("wx_user_id","",{expires:365,path:"/"}),ddb.cookie("wx_mobile","",{expires:365,path:"/"}),ddb.cookie("wx_device_id","",{expires:365,path:"/"}),ddb.cookie("wx_ddb_token","",{expires:365,path:"/"}),ddb.cookie("wx_login_token","",{expires:365,path:"/"}),ddb.cookie("wx_user_open_id","",{expires:365,path:"/"}),ddb.cookie("wx_device_id","",{expires:365}),ddb.cookie("wx_mobile","",{expires:365}),ddb.cookie("wx_user_id","",{expires:365}),ddb.cookie("wx_ddb_token","",{expires:365}),ddb.cookie("wx_login_token","",{expires:365}),ddb.cookie("wx_user_open_id","",{expires:365}),e)return e(),void 0;B.user.login()}else ddb.msg(t.msg)})},B.user.getAddress=function(){if(B.user.isLogin()){var e=JSON.parse(localStorage.getItem("__dadabus_common_address_"+ddb.cookie("wx_user_id")+"__")),t=location.href;if(!e)return!1;$.isPlainObject(e.company)&&(t=B.url.getParam("on_site")?t:B.url.setParam("on_site",e.company.title,t),t=B.url.getParam("on_site_lng")?t:B.url.setParam("on_site_lng",e.company.lng,t),t=B.url.getParam("on_site_lat")?t:B.url.setParam("on_site_lat",e.company.lat,t)),$.isPlainObject(e.home)&&(t=B.url.getParam("off_site")?t:B.url.setParam("off_site",e.home.title,t),t=B.url.getParam("off_site_lng")?t:B.url.setParam("off_site_lng",e.home.lng,t),t=B.url.getParam("off_site_lat")?t:B.url.setParam("off_site_lat",e.home.lat,t))}};var ddb={};switch(ddb.version="1.7.0",location.hostname.split(".")[0]){case"dev":case"loc":ddb.dev_status="dev";break;case"test":ddb.dev_status="test";break;default:ddb.dev_status="release"}ddb.api=ddb.train_api="http://"+("release"===ddb.dev_status?"":ddb.dev_status+".")+"api.dadabus.com/",ddb.wxapi="/v2/app/api?parames=",ddb.xhrs=[],ddb.noop=function(){},function(){function e(e,t,o,n){function i(e){if(0!==+e.ret){if(8001===+e.ret||8002===+e.ret||8003===+e.ret){if(B.user.isLogin()&&B.user.logout(),t.notCheckLogin)return r.reject(e),!1;var n="http://"+location.host+"/v2/res/src/tpl/login.html";location.href=B.url.setParam("referrer",location.href,n)}if(6001===+e.ret)return ddb.isWeixin&&!t.notCheckLogin&&ddb.getOpenId(0,!0),r.reject(e),!1}"function"==typeof o&&o(e),r.resolve(e)}m();var a,r=$.Deferred(),d=$.extend({},g),s=t.cachekey;return e="app"===t.urlType?t.url||e:"train.api"===t.urlType?ddb.train_api+e:t.url||ddb.api+e,s&&sessionStorage[s]?(console.log("Cached: ",!!sessionStorage[s]),i(JSON.parse(sessionStorage[s])),r.promise()):(t.noLoading||ddb.loading.show(),a=$.ajax({url:e,dataType:t.dataType||"json",type:"GET",data:$.extend(d,t),success:function(e){ddb.loading.hide(),i(e),console.log("get: ",e),s&&(sessionStorage[s]=JSON.stringify(e))},error:function(e){ddb.loading.hide(),"function"==typeof n&&n(e),console.log("网络异常：",e),r.reject(e)}}),ddb.xhrs.push(a),t.returnXhr?a:r.promise())}function t(e,t,o,n){function i(e){if(0!==+e.ret&&(8001===+e.ret||8002===+e.ret||8003===+e.ret)){B.user.isLogin()&&B.user.logout();var t="http://"+location.host+"/v2/res/src/tpl/login.html";return location.href=B.url.setParam("referrer",location.href,t),r.reject(),!1}o(e),r.resolve(e)}m();var a,r=$.Deferred(),d=$.extend({},g),s=t.cachekey;return e="app"===t.urlType?e:ddb.api+e,s&&sessionStorage[s]?(console.log("Cached: ",!!sessionStorage[s]),i(JSON.parse(sessionStorage[s])),r.promise()):(t.noLoading||ddb.loading.show(),a=$.ajax({url:e,dataType:"json",type:"POST",data:$.extend(d,t),success:function(e){ddb.loading.hide(),i(e),console.log("post:",e),s&&(sessionStorage[s]=JSON.stringify(e))},error:function(e){ddb.loading.hide(),"function"==typeof n&&n(e),console.log("网络异常：",e),r.reject()}}),ddb.xhrs.push(a),r.promise())}function o(e,t,o,n){function i(e){o(e),r.resolve(e)}m();var a,r=$.Deferred(),d=$.extend({},g),s=t.cachekey;return e="app"===t.urlType?e:ddb.api+e,s&&sessionStorage[s]?(console.log("Cached: ",!!sessionStorage[s]),i(JSON.parse(sessionStorage[s])),r.promise()):(t.noLoading||ddb.loading.show(),a=$.ajax({url:e,dataType:"jsonp",type:"GET",jsonp:"cb",data:$.extend(d,t),success:function(e){ddb.loading.hide(),i(e),console.log(e),s&&(sessionStorage[s]=JSON.stringify(e))},error:function(e){ddb.loading.hide(),"function"==typeof n&&n(e),console.log("网络异常：",e),r.reject(e)}}),ddb.xhrs.push(a),r.promise())}function n(e,t){var o="http://"+location.host+"/v2/wechat_menu/getOpenId?";o=B.url.setParam("referrerSrc",e?e:location.href,o);var n="";if(t){var i="https://open.weixin.qq.com/connect/oauth2/authorize?",a="wx108854b0f729a8e5";"release"===ddb.dev_status&&(a="wx72a2b17c7ed41fe8"),n=B.url.setObj(i,{appid:a,redirect_uri:o,response_type:"code",scope:"snsapi_base"}),n+="#wechat_redirect"}else n=o;1!=B.url.getParam("hasOpenid")&&(location.href=n)}function i(e,t,o){function n(e,t,o){var n=o.expires,i=o.path,a=o.domain,r=o.secure;return"number"==typeof n&&(n=new Date((new Date).getTime()+864e5*n)),document.cookie=e+"="+escape(t)+(n?"; expires="+n.toUTCString():"")+(i?"; path="+i:"")+(a?"; domain="+a:"")+(r?"; secure":""),!0}function i(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!==t?unescape(t[2]):""}function a(e,t){return t.expires=new Date(0),n(e,"",t)}return o=o||{},"undefined"==typeof t?i(e):null===t||""===t?a(e,o):n(e,t,o)}function a(e,t,o){var n="http://"+location.host+"/v2/res/src/tpl/"+e,i=t?t:n;o?window.history.replaceState(history.state,"",i):location.href=i}function r(e,t,o){if(window[e]){if("undefined"!=typeof o)return null===o||""===o?window[e].removeItem(t):window[e].setItem(t,JSON.stringify(o));try{return JSON.parse(window[e].getItem(t))}catch(n){return window[e].getItem(t)}}}function d(e,t){return r("localStorage",e,t)}function s(e,t){return r("sessionStorage",e,t)}function c(e,t,o,n){var i=function(e,t,o,n){e=encodeURIComponent(e),t=encodeURIComponent(t),o=encodeURIComponent(o),n=encodeURIComponent(n);var i=function(e){var t;t=document.createElement("iframe"),t.setAttribute("src",e),t.setAttribute("style","display:none;"),t.setAttribute("height","0px"),t.setAttribute("width","0px"),t.setAttribute("frameborder","0"),document.body.appendChild(t),t.parentNode.removeChild(t),t=null};i("dadabus://page/share?thumb_url="+e+"&share_url="+t+"&share_title="+o+"&share_detail="+n)};if($.os.ios)return i(n,o,e,t),!1;if($.os.android&&window.android&&window.android.share){var a=B.url.getParam("version");!a||a>"1.7.1"?window.android.share(n,o,e,t):window.android.share(e,t)}}function l(e){("release"!==ddb.dev_status||ddb.debugMobile===ddb.cookie("wx_mobile"))&&console.log("Debug: ",e)}function p(e,t,o){var n=B.url.setParam("order_number",t,"order_details.html");switch(n=B.url.setParam("pay_status",e,n),e){case"ok":return o=o||ddb.noop,ddb.get("order/pay_confirm",{order_number:t,dada_flag:1},function(e){if(0===+e.ret){if(!ddb.store("isAward")){var t=$.extend(ddb.pgps("award")||{},{show_award:e.data.show_award,award_title:e.data.award_title,award_msg:e.data.award_msg});ddb.pgps("award",t),ddb.store("isAward",1)}switch(e.data.status){case"success":ddb.pgps("recommend_lines",null),ddb.pgps("api_wait_bus",null),o(),ddb.jump(n+"#page-pay-success");break;case"error invalid_order_number":alert("订单号错误");break;case"order_unpaid":alert("订单未支付");break;case"order_has_been_canceled":alert("订单已取消");break;case"failed":alert("其他错误")}}}),void 0;case"cancel":break;case"fail":}ddb.jump(n)}function u(e,t){{var o=e.order_number;e.charge_info}return t=t||ddb.noop,o?"release"!==ddb.dev_status?(ddb.Popup.confirm({title:"模拟支付",content:"【测试环境】使用模拟支付，请选择",cancelText:"失败测试",okText:"支付",clickMask2Close:!1,cancelCall:function(){t(),p("fail",o)},okCall:function(){var e={urlType:"app",order_number:o};ddb.get("/v2/app/payTest/",e,function(e){0===+e.ret?(t(),p("ok",o)):ddb.debug(e)},function(e){ddb.debug(e)})}}),void 0):(ddb.isWeixin?(e=$.extend({urlType:"app"},e),ddb.get("/v2/app/weixinOerderPay/",e,function(e){0===+e.ret?(t(),WeixinJSBridge.invoke("getBrandWCPayRequest",e.msg,function(e){"get_brand_wcpay_request:ok"===e.err_msg?p("ok",o):"get_brand_wcpay_request:cancel"===e.err_msg?p("cancel",o):p("fail",o)})):(ddb.msg(e.msg),ddb.debug(e))},function(e){ddb.debug(e)})):ddb.get("order/h5_alipay",{order_number:o,return_url:"http://"+location.host+"/v2/res/src/tpl/order_details.html?pay_status=ok&order_number="+o},function(e){0===+e.ret?(t(),$(e.data.alipay_html).hide().appendTo("body")):ddb.msg(e.msg)},function(e){ddb.debug(e)}),void 0):(ddb.msg("订单号无效 T_T"),t(),void 0)}function b(e){return alert(e)}var g={version:ddb.version,user_id:"0",login_type:1,device_type:3,mobile:"",device_id:"",ddb_token:"",ddb_src_id:"",lat:1,lng:1,source:3},m=function(){var e=i("wx_mobile"),t=ddb.pgps("ddb_user_gps"),o=localStorage.getItem("ddbCity");e&&e!==g.mobile&&(g.mobile=e,g.user_id=i("wx_user_id"),g.device_id=i("wx_device_id"),g.ddb_token=i("wx_ddb_token"),g.ddb_token||(g.login_token=i("wx_login_token"))),g.ddb_src_id=B.url.getParam("ddb_src_id")||i("ddb_src_id"),g.city_code=o?o.split("/")[1]:"0755",t&&(g.lng=t.lng,g.lat=t.lat,g.gps_sampling_time=t.gps_sampling_time),g.cache_time=Math.random()};ddb.jump=a,ddb.get=e,ddb.post=t,ddb.getJsonp=o,ddb.store=d,ddb.cookie=i,ddb.submitPay=u,ddb.debug=l,ddb.msg=b,ddb.pgps=s,ddb.app=c,ddb.payResultShow=p,ddb.getOpenId=n,ddb.isWeixin=/MicroMessenger/i.test(window.navigator.userAgent),ddb.abortXHRs=function(){ddb.xhrs.forEach(function(e){e.abort(),console.log("Abort XHR: ",e)}),ddb.xhrs=[]},ddb.showShareit=function(){if(!ddb.isWeixin)return ddb.wx.gotoPublic(),void 0;var e=document.getElementById("shareit");e?e.style.display="block":$('<div id="shareit"><p>点击右上角分享</p></div>').appendTo("body").on("click",function(){this.style.display="none"})}}(),ddb.wx={},ddb.wx.getInfo=function(e){ddb.get(ddb.wxapi+"wechat_api/jssdk",{urlType:"app",wxUrl:location.href},function(t){0===+t.ret?(ddb.JSSDK_CFG=t.JSSDK_CFG,ddb.openid=t.JSSDK_CFG.openid,e&&e(t.JSSDK_CFG)):console.log(t.msg)})},ddb.wx.share=function(e,t){function o(o){0===+o.ret&&(console.log("openid: ",o.open_id),wx.config($.extend({debug:t||!1,appId:o.msg.appId,timestamp:o.msg.timestamp,nonceStr:o.msg.nonceStr,signature:o.msg.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareQZone","showMenuItems","openLocation","getLocation"]},e.config||{})),wx.ready(function(){var t=$.extend({title:"一人一座舒适直达，嗒嗒巴士送你上下班。",desc:"上下班坐公交是玩命，坐专车是烧钱，坐嗒嗒巴士走心。",link:location.href,imgUrl:"http://wechat.dadabus.com/v2/res/src/image/side_avatar_default.png",timeLine_imgUrl:"http://wechat.dadabus.com/v2/res/src/image/side_avatar_default_memory.png"},e.JSSDK_Share),o={title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,success:function(){$("#shareit").hide()}};wx.onMenuShareTimeline({title:t.title,desc:t.desc,link:t.link,imgUrl:t.timeLine_imgUrl,success:function(){$("#shareit").hide()}}),wx.onMenuShareAppMessage(o),wx.onMenuShareQQ(o),wx.onMenuShareQZone(o),wx.onMenuShareWeibo(o)}))}var n=e.isShare||B.url.getParam("share");ddb.isWeixin&&window.wx&&(1==n&&($("nav button").addClass("showNone"),$("nav button.publicNum").removeClass("showNone")),e.JSSDK_CFG=e.JSSDK_CFG||ddb.JSSDK_CFG,e.JSSDK_CFG?o(e.JSSDK_CFG):ddb.wx.getInfo(o))},ddb.wx.gotoPublic=function(){return location.href="http://mp.weixin.qq.com/s?__biz=MzAxNDMzNjc2MQ==&mid=209057391&idx=1&sn=c3686736a269a755c2b3bbb69dcddf91&scene=1&key=1936e2bc22c2ceb5f0422d19def4dd7e2ead657bd6a2be972adadb5206e9105a41e4bcaeaabb99c6bb8a0a9c37a78489&ascene=1&uin=MTAzNDg1ODg4MQ%3D%3D&devicetype=Windows+8&version=61000721&pass_ticket=Koa33YxOOGuMY5d5XE%2BTNfpOefmOQ0oQUIO%2BVO0f9PbEwF0GPMj%2BeH1mkKvSd45M",!1},ddb.jumpCommonUrl=function(e){var t="http://"+("release"===ddb.dev_status?"":ddb.dev_status+".")+"jump.dadabus.com/common/load?page="+e;t=B.url.setObj(t,{version:ddb.version,device_type:3,city_code:ddb.store("ddbCity")?ddb.store("ddbCity").split("/")[1]:"0755"}),window.location=t},ddb.ui={},ddb.tl={},ddb.tl.fixPrice=function(e){if("undefined"==typeof e||!e)return e;var t=e.toString();if(0==e)return"0";if(-1==t.indexOf("."))return e;var o=t.split("."),n=o[1];0==o[0]&&(o[0]=0),n.length>=2&&(n=n.substr(0,2));for(var i=0,a=n.length;a>i;i++)n.length>0&&0==n.charAt(n.length-1)&&(n=n.slice(0,-1));return n.length>0?o[0]+"."+n:o[0]},ddb.tl.loadContent=function(e,t,o){return $.ajax({url:e,dataType:"html",timeout:15e3,cache:!0,data:t,success:function(e){o&&o(e)},error:function(){alert("网络异常!")}})},ddb.tl.clone=function(e){var t=JSON.stringify(e),o=JSON.parse(t);return o},ddb.Popup=function(){var e,t,o,n,i={center:{top:"50%",left:".5rem",right:".5rem","border-radius":".2rem"}},a={msg:'<div class="popup-content popup-msg {_class}">{content}</div>',alert:'<div class="popup-title {_class}">{title}</div><div class="popup-content {_class}">{content}</div><div id="ddb_popup_btn_container"><a data-target="closePopup" data-icon="checkmark">{ok}</a></div>',tips:'<div class="popup-tips-title">{title}</div><div class="popup-tips-content">{content}</div>',confirm:'<div class="popup-title {_class}">{title}</div><div class="popup-content {_class}">{content}</div><div id="ddb_popup_btn_container"><a class="cancel" data-icon="close">{cancel}</a><a data-icon="checkmark">{ok}</a></div>',loading:'<i class="icon spinner"></i>',center:'<div class="popup_tips">{_img}<div class="popup_tips_title">{title}</div><div class="popup_tips_text1">{text1}</div><div class="popup_tips_text2">{text2}</div></div>'},r=function(){$("body").append('<div id="ddb_popup"></div><div id="ddb_popup_mask"></div>'),o=$("#ddb_popup_mask"),t=$("#ddb_popup"),l()},d={};d.show=function(){var e=a.loading;s({html:e,pos:"loading",opacity:.1,animation:!0,clickMask2Close:!1})},d.hide=function(){c()};var s=function(e,a){var r={height:void 0,width:void 0,opacity:.6,html:"",pos:"center",clickMask2Close:!0,showCloseBtn:!0,onShow:void 0};$.extend(r,e),n=r.clickMask2Close,o.css("opacity",r.opacity),t.attr({style:"","class":""}),r.width&&t.width(r.width),r.height&&t.height(r.height);var d=$.type(r.pos);if("object"==d)t.css(r.pos);else{if("string"!=d)return console.error("错误的参数！"),void 0;if(i[r.pos]){t.css(i[r.pos]);{r.pos.indexOf("top")>-1?"top":r.pos.indexOf("bottom")>-1?"bottom":"defaultAnim"}}else t.addClass(r.pos)}o.show();var s;if(r.html?s=r.html:r.url?s=J.Page.loadContent(r.url):r.tplId&&(s=template(r.tplId,r.tplData)),r.showCloseBtn&&(s+='<div id="tag_close_popup" data-target="closePopup" class="icon cancel-circle"></div>'),t.html(s).show(),r.onShow&&r.onShow.call(t),"center"==r.pos){var c=t.height();t.css("margin-top","-"+c/2+"px")}a&&a()},c=function(){o.hide(),t.hide().empty()},l=function(){o.on("tap",function(){n&&c()}),t.on("tap",'[data-target="closePopup"]',function(){c()})},p=function(e,t,o){var n=a.alert.replace("{title}",e).replace("{content}",t).replace("{ok}",o||"确定");s({html:n,pos:"center",opacity:.6,showCloseBtn:!1})},u=function(e,t){var o=a.tips.replace("{title}",e).replace("{content}",t);s({html:o,pos:"center",opacity:.6,showCloseBtn:!1})},b=function(e,t,o,n,i,r,d){if($.isPlainObject(e)){var l=$.extend({className:"",title:"",content:"",okText:"",cancelText:"",clickMask2Close:!0,okCall:function(){},cancelCall:function(){}},e);e=l.className;var t=l.title,o=l.content,n=l.cancelText,i=l.okText,r=l.okCall,d=l.cancelCall,p=l.clickMask2Close}else n=n||"取消",i=i||"确定";console.log(l),s({html:a.confirm.replace("{title}",t).replace("{content}",o).replace("{cancel}",n).replace("{ok}",i).replace(/{_class}/g,e),pos:"center",opacity:.6,showCloseBtn:!1,clickMask2Close:p}),$('#ddb_popup_btn_container [data-icon="checkmark"]').on("click",function(){r.call(this),c()}),$('#ddb_popup_btn_container [data-icon="close"]').on("click",function(){d.call(this),c()})},g=function(t){e&&clearTimeout(e);var o=a.msg.replace("{content}",t);s({html:o,pos:"center",opacity:.6,showCloseBtn:!1})},m=function(t,o,n){var t=t||"";e&&clearTimeout(e);var i=a.center.replace("{_img}",t).replace("{title}",o.title).replace("{text1}",o.text1).replace("{text2}",o.text2);s({html:n||i,pos:"center",opacity:0,showCloseBtn:!1},function(){$("#ddb_popup").css("background","rgba(0, 0, 0, 0)")}),e=setTimeout(function(){c(),o.callback&&o.callback()},o.delay||3e3)};return r(),{loading:d,show:s,close:c,alert:p,tips:u,msg:g,confirm:b,center:m}}(),ddb.Toast=function(e){var t,o,n="toast",i={toast:'<a href="#">{value}</a>',success:'<a href="#"><i class="icon checkmark-circle"></i>{value}</a>',error:'<a href="#"><i class="icon cancel-circle"></i>{value}</a></div>',info:'<a href="#"><i class="icon info-2"></i>{value}</a>'},a=function(){e("body").append('<div id="ddb_toast"></div>'),t=e("#ddb_toast"),s()},r=function(){t.hide(),t.empty()},d=function(e,a,d){o&&clearTimeout(o),a=a||"toast",d=d||3e3;var s=a.split(/\s/);n=s[0],t.attr("class",a).html(i[n].replace("{value}",e)).show(),0!==d&&(o=setTimeout(r,d))},s=function(){t.on("tap",'[data-target="close"]',function(){r()})};return a(),{show:d,hide:r}}($),ddb.loading=ddb.Popup.loading,window.oAlert=window.alert,window.alert=ddb.Toast.show,"release"!==ddb.dev_status||B.url.getParam("debug")||(window.onerror=console.log=console.error=console.debug=console.warn=console.info=ddb.noop),ddb.cookie("ddb_src_id")||(ddb.cookie("ddb_src_id",B.url.getParam("ddb_src_id"),{path:"/"}),console.log("ddb_src_id: ",ddb.cookie("ddb_src_id"))),ddb.inPublic=location.pathname.indexOf("/public/")>-1,ddb.inPublic&&(console.log("In public dir"),ddb.get=ddb.getJsonp),$(function(){var e=$("button.newBack, .g-navbar .back");e.on("click",function(){document.referrer?window.history.go(-1):window.location="../tpl/mine.html"}),"tplMsg"===B.url.getParam("from")&&e.hide(),ddb.isWeixin&&ddb.wx.share({isShare:0,JSSDK_Share:{link:"http://a.app.qq.com/o/simple.jsp?pkgname=com.newdadabus"}})});var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?49b8570cab2a592c7934a2602c83aaac";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
avalon.config({loader:!1}),avalon.ready(function(){$(".showHidden").removeClass("showHidden"),$("[ms-controller][hidden], [ms-controller] [hidden]").removeAttr("hidden"),$("[invisible]").removeAttr("invisible")}),avalon.filters.fnSlice=function(e,r){if("undefined"==typeof e||!e)return e;var t=e.slice(0,-r);return t},avalon.filters.fnRound=function(e){return"undefined"!=typeof e&&e?Math.round(e):e},avalon.filters.floatCutZero=function(e){var r=e+"";return-1!==r.indexOf(".")&&(r=r.replace(/0+$/g,"")),+r},avalon.filters.cutZero=function(e){return+String(e).replace(/^0+/g,"")},avalon.filters.fnDelZero=function(e){return ddb.tl.fixPrice(e)},avalon.filters.fnOrderListStatus=function(e,r){var t="";if(!e)return t;switch(+e){case 0:t="待支付";break;case 1:t="已支付";break;case 2:t="已取消"}return r&&(t=r.charAt(0)+t+r.charAt(1)),t},avalon.filters.payStatusTitleFilter=function(e){var r="";if(!e)return r;switch(+e){case 1:r="实付";break;case 0:case 2:r="应付"}return r},avalon.filters.toChineseNumber=function(e,r){if(!e)return"";var t=["一","二","三","四","五","六","七","八","九","十","十一","十二"],n=[1,2,3,4,5,6,7,8,9,10,11,12],a=n.indexOf(+e),i=r?t[a]+r:t[a];return i},avalon.filters.fnRequest=function(e){if("undefined"==typeof e||""===e)return e;var r="";return r=0==e?"求开通":"已请求"},avalon.filters.joinStatusFilter=function(e){var r="";if("undefined"==typeof e)return"";switch(+e){case 0:r="待报名";break;case 1:r="已报名";break;case 2:r="已发起"}return r},avalon.filters.lineStatusFilter=function(e,r){var t="";return 1===+r?t="已开通":1===+e?t="已报名":2===+e&&(t="已发起"),t},avalon.filters.ticketBtnStatus=function(e){var r="未到出票时间";return"undefined"==typeof e?r:(0===+e?r="电子票已过期":2===+e&&(r="未到出票时间"),r)},avalon.filters.siteTypeFilter=function(e){var r="";switch(+e){case 1:r="始发";break;case 2:r="途经"}return r},avalon.filters.companyName=function(e,r){var t="车企详情";return e&&r&&(t=e.length<7?e:"<marquee>"+e+"</marquee>"),t},avalon.filters.orderRealRriceTitle=function(e,r){if(!e)return e;var t="";switch(e){case"0":case"2":t=r?"应"+r+"付":"应付";break;case"1":t=r?"实"+r+"付":"实付"}return t},avalon.filters.dailyTicketStatusFilter=function(e,r){return e?(e=e.split(" "),-1!==e.indexOf("valid")?r:-1!==e.indexOf("full")?"已满":-1!==e.indexOf("buy")?"已购":-1!==e.indexOf("refund")?"已退":""):""},avalon.filters.fnOverflow=function(e){if(!e)return e;var r=e;return e.length>12&&(r=r.substr(0,11)+"..."),r},avalon.filters.cityTicketFilter=function(e,r){return e&&3!=r?1==r?"余"+e+"张":2==r?"有票":"无票":"售罄"},avalon.filters.refundProcessFilter=function(e,r){var t="退票申请已提交";return e=+e,1===e||3===e||5===e||6===e?(t="退票中",(5===e||6===e)&&(t="嗒嗒审核通过")):2===e||4===e||7===e?(t="退票失败",2===e?t="嗒嗒审核不通过":4===e?t="嗒嗒审核不通过":7===e&&(1===r?t="嗒嗒审核通过":2===r&&(t="处理失败"))):8===e&&(t="退票成功",1===r?t="嗒嗒审核通过":2===r&&(t="处理成功")),t},avalon.filters.payTypeFilter=function(e){var r="";switch(+e){case 0:break;case 1:r="微信";break;case 2:r="支付宝";break;case 3:r="银联";break;case 5:r="企业"}return r},avalon.filters.ticketTypeFilter=function(e){var r="";switch(+e){case 1:r="日票";break;case 2:r="月票"}return r},avalon.filters.payStatusFilter=function(e){var r="支付成功";switch(e){case"ok":r="支付成功"}return r},avalon.filters.tripTypeFilter=function(e){var r="";if(!e)return"";switch(e){case"1":r="单程";break;case"2":r="往返";break;case"3":r="包天"}return r},avalon.filters.busOrderState=function(e){if(!e)return"";switch(e){case"1":ret="待审核";break;case"2":ret="报价中";break;case"3":ret="审核不通过";break;case"4":ret="订单关闭";break;case"5":ret="报价中";break;case"6":ret="订单关闭";break;case"7":ret="订单关闭";break;case"8":ret="订单关闭"}return ret},avalon.filters.unixFormat=function(e){var r="";return e?r=moment(1e3*parseInt(e)).format("YYYY-MM-DD HH:mm:ss"):""},avalon.filters.mobileFormat=function(e){var r="";return e?r=e.substring(0,3)+"-"+e.substring(3,7)+"-"+e.substring(7):""},avalon.filters.discountPriceFilter=function(e,r){var t="";return e?(e=ddb.tl.fixPrice(e),r=ddb.tl.fixPrice(r),t=r&&e>r?'<span class="discount-price"><del>'+e+"元</del>低至</span> <em>"+r+"</em>元":"<em>"+e+"</em>元"):""},avalon.filters.ePayStatusFilter=function(e){var r="";return e?(2===+e?r="（未开通）":3===+e&&(r="（账户余额不足）"),r):""},avalon.filters.monthlyTicketStatusFilter=function(e,r){var t="";return e?(1===+e?t="余"+r+"张":2===+e?t="有票":3===+e&&(t="已满"),t):""},avalon.filters.number=function(e,r,t,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a=isFinite(+e)?+e:0,i=isFinite(+r)?Math.abs(r):3,s=n||"",l=t||".",u=function(e,r){var t=Math.pow(10,r);return""+(Math.round(e*t)/t).toFixed(r)},o=(i?u(a,i):""+Math.round(a)).split(".");return o[0].length>3&&(o[0]=o[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),(o[1]||"").length<i&&(o[1]=o[1]||"",o[1]+=new Array(i-o[1].length+1).join("0")),o.join(l)};